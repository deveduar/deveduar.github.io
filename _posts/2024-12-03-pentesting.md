creation date: 2024-12-03 03:52
tags:
  - Hacking
  - pentesting
keywords:
source:
status: üåü
Parent: "Area-Sistemas"
cssclasses:
  - hide-embedded-header1
  - wide
categories: "[ciberseguridad](/ciberseguridad/ciberseguridad/)"
public_note: "true"
# Pentesting

- [hardening](/ciberseguridad/hardening/)
- [ciberseguridad](/ciberseguridad/ciberseguridad/)
- [vulnerabilidades](/ciberseguridad/vulnerabilidades/)

## Ataques WiFi
- pentest en casa
- [GitHub - elcaza/get_off_my_wifi: La colecci√≥n de notas que me hubiera gustado encontrar sobre ataques WIFI.](https://github.com/elcaza/get_off_my_wifi)
- T√©cnicas comunes: sniffing, rogue AP, WPA/WPA2 cracking, deauth attacks, WPS exploits.
- Herramientas recomendadas: Aircrack-ng, Wireshark, Kismet, Reaver, Bettercap.

## OSINT y recolecci√≥n de data
- [OSINT](/ciberseguridad/osint/)
- T√©cnicas de reconocimiento: Google Dorking, redes sociales, WHOIS, Shodan, recon-ng.
- Automatizaci√≥n: herramientas como Maltego, SpiderFoot, TheHarvester.
- Consideraciones √©ticas y legales al recolectar informaci√≥n p√∫blica.

## Metodolog√≠as y frameworks de pentesting
- [OWASP](/ciberseguridad/owasp/)  
	- OWASP Top 10, Testing Guide, ASVS.
- [OSSTMM](/ciberseguridad/osstmm/)  
	- Modelo completo de an√°lisis de seguridad, m√©tricas y controles.
- [ISAAF](/ciberseguridad/isaaf/)  
	- Metodolog√≠a de pruebas de seguridad estructuradas, especialmente web y aplicaciones m√≥viles.
- Enfoque general: planificaci√≥n ‚Üí recolecci√≥n de informaci√≥n ‚Üí enumeraci√≥n ‚Üí explotaci√≥n ‚Üí post-explotaci√≥n ‚Üí reporte.

## Certificaciones de pentesting
- [eJPT](/ciberseguridad/ejpt/) ‚Äì Nivel inicial, enfoque pr√°ctico.
- [eCPPT](/ciberseguridad/ecppt/) ‚Äì Nivel intermedio, pr√°cticas en laboratorio real.
- [eWPT](/ciberseguridad/ewpt/) ‚Äì Web penetration testing.
- [Red team](/ciberseguridad/red-team/) ‚Äì Certificaciones enfocadas en ataques avanzados y simulaciones reales de adversarios.

## Herramientas de reporte y gesti√≥n
- blackstone
	- Informes de seguridad estructurados.
	- [GitHub - micro-joan/BlackStone: Pentesting Reporting Tool](https://github.com/micro-joan/BlackStone)
	- Tablas de criticidad y priorizaci√≥n de vulnerabilidades.
	- [C√≥mo crear reportes con BlackStone Project 2.0 - Daniel Maldonado](https://danielmaldonado.com.ar/seguridad/como-crear-reportes-con-blackstone-project-2-0/)
	- Integraci√≥n de hallazgos con [vulnerabilidades](/ciberseguridad/vulnerabilidades/) y resultados de pruebas.

## Seguridad ofensiva
- [¬øQu√© es la seguridad ofensiva? | IBM](https://www.ibm.com/es-es/topics/offensive-security#:~:text=La%20seguridad%20ofensiva%2C%20u%20%22OffSec,red%20en%20lugar%20de%20da%C3%B1arla.)
- Concepto: Evaluaci√≥n activa de sistemas para identificar vulnerabilidades antes de que los atacantes lo hagan.
- Enfoques: red, aplicaciones, nube, IoT, ingenier√≠a social.
- Integraci√≥n con pentesting, red teaming y auditor√≠as de seguridad.

## Herramientas de Pentesting en Linux
- tools [Linux](/sistemas/linux/)
	- Z4nzuhackingtool ALL IN ONE Hacking Tool For Hackers-hackingtool
		- Framework todo‚Äëen‚Äëuno para automatizar tareas de reconocimiento, escaneo y explotaci√≥n.
		- √ötil en fases iniciales para acelerar pruebas repetitivas en entornos controlados.
	- Las 25 mejores herramientas de Pentesting para Kali Linux-Herramientas_de_enumeracion
		- Recopilaci√≥n clave para enumeraci√≥n, explotaci√≥n, post‚Äëexplotaci√≥n y reporting.
		- Referencia pr√°ctica para seleccionar herramientas seg√∫n el objetivo del test.

## Documentaci√≥n y fases de Pentesting
- docs
	- Learn About The Five Penetration Testing Phases  Pentesting  EC-Council- 1
		- Marco cl√°sico de 5 fases: reconocimiento, escaneo, obtenci√≥n de acceso, mantenimiento del acceso y reporte.
		- Base conceptual para alinear metodolog√≠as como [OWASP](/ciberseguridad/owasp/) y [OSSTMM](/ciberseguridad/osstmm/).

## Reportes de Pentesting
- reportes
	- Templates y blueprints
		- Estructuras reutilizables para informes t√©cnicos y ejecutivos.
	- Narrative Attacks  ThreatNG
		- Enfoque narrativo para explicar ataques complejos de forma comprensible a negocio.
	- What So what Now what   Reflection Toolkit-what-so-what-now-what
		- Marco de reflexi√≥n para contextualizar impacto, riesgo y acciones.
	- Pentest a las Big Four (consultor√≠a y venta)
		- Enfoque comercial: riesgo, cumplimiento, impacto financiero y roadmap.
	- Report de [Nessus](/ciberseguridad/nessus/)
		- Informes automatizados basados en CVSS y detecci√≥n de vulnerabilidades conocidas.
	- Mandiant, Kaspersky Security, breach reports
		- Informes de referencia para an√°lisis post‚Äëincidente y benchmarking de amenazas.

## Ataques
- [vulnerabilidades](/ciberseguridad/vulnerabilidades/)
- **Ataques de red y servicios**
	- Una introducci√≥n a Responder-
		- Envenenamiento LLMNR/NBT‚ÄëNS para captura de hashes en redes internas.
- **Ingenier√≠a social y documentos**
	- gpt  como meter troyano en documento
		- An√°lisis conceptual de vectores de entrega y concienciaci√≥n defensiva.
- **An√°lisis de n√∫meros telef√≥nicos**
	- analizar numeros phone infoga rastros
	- analizar numeros de telefono con web app
		- [OSINT](/ciberseguridad/osint/)
		- Clon de fast people search.com o uso de API para correlaci√≥n de datos.
- **Explotaci√≥n de vulnerabilidades RFI y LFI**
	- Ataque con acceso a [vulnerabilidades](/ciberseguridad/vulnerabilidades/) RFI y LFI
		- Tratamiento de la TTY
			- Tratamiento de la TTY-
			- brightiopenelope Penelope Shell Handler-penelope
		- [OSCP](/ciberseguridad/oscp/)
		- Difference between RFI and LFI-
		- Apache con cabeceras
			- User-Agent - HTTP  MDN-User-Agent
		- whoami-whoami
		- Envenenamiento de logs e inyecci√≥n de c√≥digo
			- Explotaci√≥n de la vulnerabilidad Log Poisoning mediante LFI, RFI y RCE, explicaciones y PoC-
			- Log Poisoning  H4CKdotCL-log-poisoning
- **An√°lisis de hashes y credenciales**
	- Entornos [Active Directory](/sistemas/active-directory/) y [Windows Server](/devops/windows-server/)
	- Dumpear SAM
		- sam  The Hacker Tools-sam
	- mimkatz
		- What is Mimikatz The Beginner's Guide-what-is-mimikatzdownload
		- Mimikatz Comprehensive Guide-
	- [autenticacion](/autenticacion/autenticacion/) y credenciales de acceso
		- Detecci√≥n de debilidades en pol√≠ticas y configuraciones.
	- [Kerberos](/autenticacion/kerberos/) como protocolo de autenticaci√≥n
		- [ticketing](/management/ticketing/)
		- [Windows Server](/devops/windows-server/)
		- ¬øQu√© es Kerberos Explicaci√≥n de la autenticaci√≥n de Kerberos-kerberos-authentication
		- Introducci√≥n a la autenticaci√≥n Kerberos en Windows Server-kerberos-authentication-overview
		- ¬øQu√© es un ataque de kerberoasting  IBM-kerberoasting

## Hardening y defensa post‚Äëpentest
- script de hardening powershell
	- Automatizaci√≥n de mitigaciones tras hallazgos en entornos Windows.
	- Cierre del ciclo de pentesting: detecci√≥n ‚Üí explotaci√≥n ‚Üí remediaci√≥n.
# Pentesting Avanzado

## Pentesting Web Avanzado
- **Tipos de ataques**
	- XSS (Cross-Site Scripting): inyecci√≥n de scripts en el navegador del usuario.
	- SQLi (SQL Injection): manipulaci√≥n de consultas SQL para extraer o modificar datos.
	- SSRF (Server-Side Request Forgery): explotaci√≥n de servidores para acceder a recursos internos.
	- Deserializaci√≥n insegura: ejecuci√≥n remota de c√≥digo mediante datos serializados manipulados.
	- Ataques a APIs REST/GraphQL: manipulaci√≥n de endpoints para bypass de autenticaci√≥n, extracci√≥n de datos o ejecuci√≥n de operaciones no autorizadas.
- **Herramientas**
	- Burp Suite: proxy, scanner y manipulaci√≥n de requests/responses.
	- OWASP ZAP: escaneo automatizado y an√°lisis de seguridad web.
	- SQLmap: automatizaci√≥n de detecci√≥n y explotaci√≥n de SQLi.
- **T√©cnicas avanzadas**
	- Bypass de WAF/IDS: evasi√≥n de filtros mediante encoding, fragmentaci√≥n de payloads y fuzzing avanzado.
	- Reconocimiento de comportamiento de seguridad y fingerprinting de aplicaciones web.

## Pentesting de Red e Infraestructura
- **Tareas comunes**
	- Escaneo de puertos y servicios para enumeraci√≥n.
	- Fingerprinting de sistemas operativos y aplicaciones.
	- Ataques a protocolos y servicios: SMB, FTP, SNMP, RDP.
- **Herramientas**
	- Nmap: escaneo y detecci√≥n de hosts/servicios.
	- Masscan: escaneo r√°pido de grandes rangos de IP.
	- Metasploit: explotaci√≥n de vulnerabilidades conocidas.
	- CrackMapExec: post-explotaci√≥n y auditor√≠a de redes Windows.
- **Explotaci√≥n**
	- Servicios legacy con vulnerabilidades conocidas.
	- Configuraciones inseguras y credenciales por defecto.

## Pentesting de Nube y Contenedores
- **Servicios Cloud**
	- AWS, Azure, GCP: identificaci√≥n de malas configuraciones, permisos excesivos, buckets S3 p√∫blicos, pol√≠ticas IAM inseguras.
- **Contenedores**
	- Docker, Kubernetes: explotaci√≥n de contenedores mal configurados, escalada de privilegios y vulnerabilidades comunes en clusters.
- **Herramientas**
	- Pacu: auditor√≠a de seguridad en AWS.
	- ScoutSuite: auditor√≠a de seguridad multi-cloud.
	- kube-hunter: detecci√≥n de vulnerabilidades en Kubernetes.

## Pentesting M√≥vil y Aplicaciones
- Plataformas: iOS y Android, apps h√≠bridas.
- T√©cnicas:
	- Reversing de APK/IPA.
	- Hooking con Frida para manipular el comportamiento de apps.
	- Interceptaci√≥n de tr√°fico y manipulaci√≥n de requests con Burp Suite.
- Objetivo: descubrir vulnerabilidades, fugas de datos y fallas en la autenticaci√≥n.

## Post-Explotaci√≥n y Movimiento Lateral
- **Objetivos**
	- Escalada de privilegios.
	- Persistencia en el sistema comprometido.
	- Recolecci√≥n de credenciales, hashes y tokens.
- **Herramientas**
	- BloodHound: mapeo de relaciones y permisos en Active Directory.
	- PowerSploit: scripts de post-explotaci√≥n en entornos Windows.
	- Empire: framework de post-explotaci√≥n y C2.

## Threat Emulation / Red Team
- Simulaci√≥n de ataques avanzados (APT) contra objetivos reales.
- Integraci√≥n con Blue Team: pruebas de detecci√≥n y respuesta.
- Evaluaci√≥n de alertas de SIEM y efectividad de defensas existentes.

## Automatizaci√≥n y DevSecOps
- Integraci√≥n de pentesting en pipelines CI/CD.
- Escaneo automatizado de c√≥digo y despliegues.
- Reporting continuo de vulnerabilidades y riesgos.

## Buenas Pr√°cticas y √âtica
- Legalidad y autorizaci√≥n expl√≠cita antes de realizar pruebas.
- Definici√≥n clara del alcance del pentest.
- Gesti√≥n de riesgos y comunicaci√≥n efectiva con stakeholders.
- Documentaci√≥n detallada de hallazgos, impactos y recomendaciones.

# Herramientas y Recursos Recomendados 2026

## Herramientas de Pentesting Web y Automatizaci√≥n
- **Terr–∞ Agentic AI Platform**  
	- Plataforma con testing continuo impulsado por IA que simula ataques de l√≥gica de negocio y se integra con pipelines CI/CD. [Zealstech](https://zealstech.com/top-web-application-penetration-testing-tools-every-security-expert-use/?utm_source=chatgpt.com)
- **OWASP Zed Attack Proxy (ZAP)**  
	- Esc√°ner din√°mico de aplicaciones web con inspecci√≥n de tr√°fico, fuzzing y scripting para escenarios personalizados. [Zealstech](https://zealstech.com/top-web-application-penetration-testing-tools-every-security-expert-use/?utm_source=chatgpt.com)
- **Acunetix**  
	- Esc√°ner de web y API que automatiza detecci√≥n de vulnerabilidades del OWASP Top 10 con resultados r√°pidos. [Theori.io](https://theori.io/blog/top-penetration-testing-solutions-for-it-security-2024-guide-48545?utm_source=chatgpt.com)
- **Burp Suite** (Community y Pro)  
	- Plataforma de pruebas web con capacidades manuales y automatizadas, tambi√©n integrable con CI/CD. [ACSMI](https://acsmi.org/blogs/top-penetration-testing-tools-comprehensive-comparison-2025-edition?utm_source=chatgpt.com)
- **SQLmap**  
	- Herramienta automatizada para detectar y explotar inyecciones SQL. [OSINT](https://osint.com.ar/las-herramientas-mas-utilizadas-para-el-pentesting/?utm_source=chatgpt.com)

## Redes y An√°lisis de Tr√°fico
- **Nmap / NSE**  
	- Port scanning y scripting para tareas avanzadas como enumeraci√≥n y fingerprinting. [ACSMI](https://acsmi.org/blogs/top-penetration-testing-tools-comprehensive-comparison-2025-edition?utm_source=chatgpt.com)
- **Wireshark**  
	- An√°lisis profundo de tr√°fico, detecci√≥n de patrones y estudio de protocolos en red. [ACSMI](https://acsmi.org/blogs/top-penetration-testing-tools-comprehensive-comparison-2025-edition?utm_source=chatgpt.com)
- **SAINT Network Vulnerability Scanner**  
	- Escanea redes completas buscando vulnerabilidades en servicios TCP/UDP. [Wikipedia](https://en.wikipedia.org/wiki/SAINT_%28software%29?utm_source=chatgpt.com)

## Explotaci√≥n y Post‚Äëexplotaci√≥n
- **Metasploit Framework**  
	- Framework l√≠der para explotaci√≥n de vulnerabilidades y desarrollo de payloads. [Wikipedia](https://en.wikipedia.org/wiki/Metasploit?utm_source=chatgpt.com)
- **Armitage (GUI para Metasploit)**  
	- Interfaz gr√°fica que facilita gesti√≥n de metasploit y colaboraci√≥n de equipo rojo. [Wikipedia](https://es.wikipedia.org/wiki/Armitage_%28software%29?utm_source=chatgpt.com)

## Cloud y Entornos Modernos
- **AutoSecT**  
	- Plataforma completa para pentesting en multi‚Äëcloud (AWS, GCP, Azure) con an√°lisis inteligente de vulnerabilidades y generaci√≥n de reportes. [Security Boulevard](https://securityboulevard.com/2025/03/best-cloud-pentesting-tool-in-2025-azure-aws-gcp/?utm_source=chatgpt.com)
- **Herramientas DevSecOps (Snyk, SonarQube)**  
	- Identifican vulnerabilidades en dependencias, contenedores y c√≥digo al momento de desarrollo. [Immune Institute](https://immune.institute/blog/las-20-mejores-herramientas-de-ciberseguridad-para-2026/?utm_source=chatgpt.com)

## Frameworks de Pentesting Automatizado (Emergentes)
- **RapidPen**  
	- Framework de pentesting automatizado con agentes basados en LLM para explorar y explotar desde IP inicial. [Arxiv](https://arxiv.org/abs/2502.16730?utm_source=chatgpt.com)
- **ARACNE**  
	- Agente aut√≥nomo para pentesting de servicios tipo shell/SSH con IA multimodelo. [Arxiv](https://arxiv.org/abs/2502.18528?utm_source=chatgpt.com)
- **AutoPentester**  
	- Framework autom√°tico que genera estrategias de ataque iterativas con herramientas est√°ndar. [Arxiv](https://arxiv.org/abs/2510.05605?utm_source=chatgpt.com)

## Entorno y OSINT
- **Shodan**  
	- Motor de b√∫squeda de dispositivos expuestos (IoT, c√°maras, routers) orientado a reconocimiento. [El Vigilante Digital](https://www.elvigilantedigital.com/2025/06/10/5-herramientas-gratuitas-para-iniciarte-en-la-ciberseguridad-2025/?utm_source=chatgpt.com)
- **FOCA Tool**  
	- Extracci√≥n de metadatos de documentos para descubrir informaci√≥n sensible de organizaciones. [Wikipedia](https://es.wikipedia.org/wiki/FOCA_Tool?utm_source=chatgpt.com)

## Gadgets y Equipos para Red Team
- **Raspberry Pi 5**  
	- Mini ordenador portable ideal para ejecutar herramientas y auditor√≠as en campo (Red Team / WiFi / IoT). [WeLiveSecurity](https://www.welivesecurity.com/es/recursos-herramientas/top-5-gadgets-para-red-team/?utm_source=chatgpt.com)

## Educaci√≥n y Cursos Relevantes
- Cursos de **Pentesting Web 2026**  
	- Programas especializados en t√©cnicas avanzadas de escaneo, sniffing y desarrollo de scripts. [Diplomado Ciberseguridad](https://diplomadociberseguridad.com/pentesting-web/?utm_source=chatgpt.com)
- Cursos de **Desarrollo de Herramientas de Pentesting con Python**  
	- Capacitaci√≥n para automatizar pruebas y crear herramientas personalizadas. [Diplomado Ciberseguridad](https://diplomadociberseguridad.com/desarrollo-de-herramientas-de-pentesting-con-python/?utm_source=chatgpt.com)
- Cursos integrales de **Hacking √âtico y Pentesting**  
	- Contenidos pr√°cticos de explotaci√≥n, post‚Äëexplotaci√≥n y reporting profesional. [Udemy](https://www.udemy.com/course/pentesting-y-hacking-etico-domina-la-seguridad-ofensiva/?utm_source=chatgpt.com)

## Mejores pr√°cticas de integraci√≥n
- **DevSecOps y Pentesting Continuo**  
	- Automatizaci√≥n de escaneos, integraci√≥n con CI/CD y escaneo de APIs y microservicios como pr√°ctica est√°ndar en 2026. [CiberSafety](https://cibersafety.com/futuro-hacking-etico-pentesters-2026/?utm_source=chatgpt.com)
- **Modelos h√≠bridos de pruebas**  
	- Combinaci√≥n de automatizaci√≥n (IA/ML) y validaci√≥n humana para identificar falsos positivos y escenarios complejos. [BrightDefense](https://www.brightdefense.com/resources/hybrid-penetration-testing/?utm_source=chatgpt.com)
# Caso Pr√°ctico de Pentesting Real ‚Äî Entorno Corporativo

## Contexto del Proyecto
- Tipo de cliente: empresa mediana del sector financiero.
- Alcance:
	- Aplicaci√≥n web p√∫blica (portal de clientes).
	- Infraestructura interna (red corporativa Windows).
	- Servicios expuestos a Internet.
- Objetivo:
	- Identificar vulnerabilidades explotables.
	- Evaluar impacto real en confidencialidad, integridad y disponibilidad.
	- Proveer recomendaciones accionables.

## Alcance y Reglas de Compromiso
- Ventana de pruebas: 2 semanas.
- Tipo de prueba: caja gris.
- Accesos iniciales:
	- Usuario de bajo privilegio en la aplicaci√≥n web.
- Exclusiones:
	- Denegaci√≥n de servicio (DoS).
	- Ingenier√≠a social activa a empleados.

## Fase 1 ‚Äî Reconocimiento
- OSINT:
	- Enumeraci√≥n de dominios y subdominios.
	- Identificaci√≥n de tecnolog√≠as web y frameworks.
- Herramientas:
	- Nmap (servicios expuestos).
	- Shodan (activos publicados accidentalmente).
- Hallazgos:
	- Subdominio de pruebas accesible p√∫blicamente.
	- Servidor Apache desactualizado.

## Fase 2 ‚Äî Enumeraci√≥n
- Enumeraci√≥n web:
	- An√°lisis de endpoints REST no documentados.
	- Descubrimiento de par√°metros vulnerables.
- Enumeraci√≥n de red interna:
	- SMB signing deshabilitado.
	- Usuarios de dominio accesibles por LDAP.
- Herramientas:
	- Burp Suite.
	- CrackMapExec.
	- Nmap NSE.

## Fase 3 ‚Äî Explotaci√≥n
- Vulnerabilidades explotadas:
	- SQLi en endpoint REST:
		- Extracci√≥n de datos de clientes.
	- LFI con Log Poisoning:
		- Ejecuci√≥n remota de comandos en servidor web.
- Acceso inicial:
	- Reverse shell con usuario www-data.
- Evidencias:
	- Dumps de base de datos.
	- Capturas de ejecuci√≥n remota.

## Fase 4 ‚Äî Post‚ÄëExplotaci√≥n
- Escalada de privilegios:
	- Enumeraci√≥n de binarios SUID.
	- Obtenci√≥n de root mediante mala configuraci√≥n.
- Movimiento lateral:
	- Captura de hashes NTLM.
	- Uso de Pass‚Äëthe‚ÄëHash contra servidores internos.
- Herramientas:
	- LinPEAS.
	- Mimikatz.
	- BloodHound.

## Fase 5 ‚Äî Impacto
- Acceso completo a:
	- Base de datos de clientes.
	- Servidor de archivos interno.
	- Controlador de dominio secundario.
- Riesgos:
	- Robo masivo de datos.
	- Persistencia silenciosa.
	- Escalada a ransomware o sabotaje interno.

## Fase 6 ‚Äî Reporte
- Entregables:
	- Informe ejecutivo (riesgo y negocio).
	- Informe t√©cnico detallado.
- M√©tricas:
	- CVSS.
	- Impacto CIA.
- Evidencias:
	- Capturas.
	- Comandos ejecutados.
	- Hashes y rutas afectadas.

## Fase 7 ‚Äî Recomendaciones
- Corto plazo:
	- Parchar Apache y dependencias.
	- Deshabilitar SMB sin signing.
- Medio plazo:
	- Hardening de Active Directory.
	- Revisi√≥n de controles de acceso a APIs.
- Largo plazo:
	- Integrar pentesting continuo en CI/CD.
	- Monitorizaci√≥n con SIEM y detecci√≥n de comportamiento an√≥malo.

## Valor para el Negocio
- Reducci√≥n de superficie de ataque.
- Concienciaci√≥n t√©cnica y ejecutiva.
- Priorizaci√≥n de inversiones en seguridad.
- Mejora del plan de respuesta a incidentes.

# Mapeo del Caso de Pentesting contra MITRE ATT&CK y OWASP (Red Team)

## Visi√≥n General del Mapeo
- Objetivo:
	- Traducir hallazgos t√©cnicos a t√°cticas y t√©cnicas reconocidas.
	- Facilitar comunicaci√≥n con Blue Team, SOC y stakeholders.
- Frameworks usados:
	- MITRE ATT&CK (Enterprise).
	- OWASP Top 10 / OWASP API Top 10.

## Fase de Reconocimiento

### MITRE ATT&CK
- **TA0043 ‚Äì Reconnaissance**
	- T1595 ‚Äì Active Scanning  
		- Escaneo de servicios con Nmap.
	- T1590 ‚Äì Gather Victim Network Information  
		- Enumeraci√≥n de hosts y servicios expuestos.
	- T1596 ‚Äì Search Open Technical Databases  
		- Uso de Shodan para identificar activos p√∫blicos.

### OWASP
- A01:2021 ‚Äì Broken Access Control  
	- Subdominios expuestos sin control.
- A05:2021 ‚Äì Security Misconfiguration  
	- Servicios de pruebas accesibles p√∫blicamente.

## Fase de Enumeraci√≥n

### MITRE ATT&CK
- **TA0007 ‚Äì Discovery**
	- T1046 ‚Äì Network Service Discovery  
	- T1087 ‚Äì Account Discovery  
	- T1016 ‚Äì Network Configuration Discovery  

### OWASP
- A05:2021 ‚Äì Security Misconfiguration  
	- Enumeraci√≥n de endpoints REST no documentados.
- API3:2019 ‚Äì Excessive Data Exposure  
	- Respuestas de API con informaci√≥n innecesaria.

## Fase de Explotaci√≥n Inicial

### MITRE ATT&CK
- **TA0001 ‚Äì Initial Access**
	- T1190 ‚Äì Exploit Public-Facing Application  
		- SQL Injection en endpoint REST.
		- LFI en aplicaci√≥n web.

### OWASP
- A03:2021 ‚Äì Injection  
	- SQLi explotada para extracci√≥n de datos.
- A05:2021 ‚Äì Security Misconfiguration  
	- Inclusi√≥n de archivos locales.
- A09:2021 ‚Äì Security Logging and Monitoring Failures  
	- Ausencia de alertas durante la explotaci√≥n.

## Ejecuci√≥n y Persistencia

### MITRE ATT&CK
- **TA0002 ‚Äì Execution**
	- T1059 ‚Äì Command and Scripting Interpreter  
		- Ejecuci√≥n de comandos v√≠a Log Poisoning.
- **TA0003 ‚Äì Persistence**
	- T1505 ‚Äì Server Software Component  
		- Webshell persistente en servidor Apache.

### OWASP
- A03:2021 ‚Äì Injection  
- A08:2021 ‚Äì Software and Data Integrity Failures  
	- Falta de validaci√≥n de entradas y logs.

## Escalada de Privilegios

### MITRE ATT&CK
- **TA0004 ‚Äì Privilege Escalation**
	- T1068 ‚Äì Exploitation for Privilege Escalation  
		- Binarios SUID mal configurados.

### OWASP
- A01:2021 ‚Äì Broken Access Control  
	- Controles de privilegios insuficientes a nivel sistema.

## Movimiento Lateral

### MITRE ATT&CK
- **TA0008 ‚Äì Lateral Movement**
	- T1550 ‚Äì Use Alternate Authentication Material  
		- Pass-the-Hash con hashes NTLM.
	- T1021 ‚Äì Remote Services  
		- Acceso v√≠a SMB y WinRM.

### OWASP
- A07:2021 ‚Äì Identification and Authentication Failures  
	- Reutilizaci√≥n de credenciales internas.

## Acceso a Credenciales

### MITRE ATT&CK
- **TA0006 ‚Äì Credential Access**
	- T1003 ‚Äì OS Credential Dumping  
		- Mimikatz para extraer credenciales.
	- T1558 ‚Äì Steal or Forge Kerberos Tickets  
		- Kerberoasting en Active Directory.

### OWASP
- A02:2021 ‚Äì Cryptographic Failures  
	- Almacenamiento inseguro de hashes.
- A07:2021 ‚Äì Identification and Authentication Failures  

## Comando y Control (C2)

### MITRE ATT&CK
- **TA0011 ‚Äì Command and Control**
	- T1071 ‚Äì Application Layer Protocol  
		- Reverse shell sobre HTTP/HTTPS.
	- T1095 ‚Äì Non-Application Layer Protocol  

### OWASP
- A09:2021 ‚Äì Security Logging and Monitoring Failures  
	- Falta de detecci√≥n de tr√°fico an√≥malo.

## Impacto

### MITRE ATT&CK
- **TA0040 ‚Äì Impact**
	- T1486 ‚Äì Data Encrypted for Impact  
		- Riesgo potencial de ransomware.
	- T1565 ‚Äì Data Manipulation  
		- Modificaci√≥n de informaci√≥n cr√≠tica.
	- T1041 ‚Äì Exfiltration Over C2 Channel  

### OWASP
- A04:2021 ‚Äì Insecure Design  
	- Ausencia de defensa en profundidad.
- A09:2021 ‚Äì Security Logging and Monitoring Failures  

## Uso del Mapeo en Red Team
- Permite:
	- Medir cobertura de detecci√≥n del Blue Team.
	- Validar reglas del SIEM frente a t√°cticas reales.
	- Priorizar mitigaciones basadas en t√©cnicas ATT&CK.
- Facilita:
	- Ejercicios Purple Team.
	- Reporting ejecutivo alineado a est√°ndares.

## Recomendaciones Estrat√©gicas
- Mapear cada hallazgo del pentest a:
	- MITRE ATT&CK ‚Üí detecci√≥n y respuesta.
	- OWASP ‚Üí remediaci√≥n en desarrollo.
- Integrar este mapeo en:
	- Informes de Red Team.
	- Playbooks de [SOC](/ciberseguridad/soc/).
	- M√©tricas de madurez de seguridad.

# Plantillas y Playbooks de Pentesting

## Plantillas de Pentesting

### Plantilla de Alcance y Reglas de Compromiso
- Objetivo del pentest.
- Tipo de prueba: caja negra, gris o blanca.
- Activos incluidos:
	- Dominios, IPs, aplicaciones, APIs.
- Exclusiones expl√≠citas:
	- DoS, ingenier√≠a social, entornos productivos cr√≠ticos.
- Ventana temporal y horarios permitidos.
- Contactos de emergencia.
- Autorizaci√≥n formal y legal.

### Plantilla de Checklist de Pentesting
- Reconocimiento:
	- OSINT, enumeraci√≥n de dominios y subdominios.
- Enumeraci√≥n:
	- Servicios, usuarios, endpoints, versiones.
- Explotaci√≥n:
	- Web, red, credenciales.
- Post‚Äëexplotaci√≥n:
	- Escalada, persistencia, movimiento lateral.
- Reporte:
	- Evidencias, impacto, recomendaciones.

### Plantilla de Informe Ejecutivo
- Resumen de riesgos cr√≠ticos.
- Impacto en negocio.
- Nivel de madurez de seguridad.
- Recomendaciones priorizadas.
- Roadmap de mitigaci√≥n.

### Plantilla de Informe T√©cnico
- Vulnerabilidad:
	- Descripci√≥n.
	- Evidencia.
	- Impacto.
	- Probabilidad.
- Vector de ataque.
- CVSS.
- Mapeo MITRE ATT&CK.
- Mapeo OWASP.
- Recomendaci√≥n t√©cnica.

### Plantilla de Registro de Evidencias
- Fecha y hora.
- Herramienta utilizada.
- Comando ejecutado.
- Resultado obtenido.
- Captura o referencia.
- Hash de integridad de evidencias.

## Playbooks de Pentesting

### Playbook de Pentesting Web
- Reconocimiento:
	- Enumerar endpoints y tecnolog√≠as.
- Pruebas:
	- XSS, SQLi, SSRF, deserializaci√≥n insegura.
- Automatizaci√≥n:
	- Escaneo inicial con herramientas.
- Validaci√≥n manual:
	- Confirmar impacto real.
- Evidencias:
	- Requests, responses, payloads.

### Playbook de Pentesting de Red
- Descubrimiento:
	- Escaneo de puertos y servicios.
- Enumeraci√≥n:
	- Usuarios, shares, pol√≠ticas.
- Explotaci√≥n:
	- Servicios vulnerables.
- Post‚Äëexplotaci√≥n:
	- Movimiento lateral.
- Documentaci√≥n:
	- Rutas de ataque.

### Playbook de Active Directory
- Enumeraci√≥n inicial:
	- Usuarios, grupos, pol√≠ticas.
- Ataques:
	- Kerberoasting.
	- Pass‚Äëthe‚ÄëHash.
- Escalada:
	- Delegaciones inseguras.
- Dominio:
	- Acceso a controladores.
- Evidencias:
	- Gr√°ficos y relaciones.

### Playbook de Cloud Pentesting
- Revisi√≥n de configuraci√≥n:
	- Permisos e identidades.
- Exposici√≥n:
	- Recursos p√∫blicos.
- Explotaci√≥n:
	- Escalada de privilegios.
- Persistencia:
	- Claves, roles, tokens.
- Reporte:
	- Riesgo y remediaci√≥n.

### Playbook de Contenedores y Kubernetes
- Enumeraci√≥n:
	- Pods, namespaces, roles.
- Ataques:
	- Escalada de privilegios.
- Persistencia:
	- Acceso al cluster.
- Impacto:
	- Acceso a secretos.
- Evidencias:
	- Configuraciones inseguras.

### Playbook de Post‚ÄëExplotaci√≥n
- Escalada de privilegios:
	- Local y remota.
- Persistencia:
	- Servicios, tareas, webshells.
- Movimiento lateral:
	- Credenciales y tokens.
- Impacto:
	- Acceso a datos cr√≠ticos.
- Limpieza:
	- Retirada de artefactos.

### Playbook de Red Team
- Objetivo:
	- Simular APT realista.
- T√©cnicas:
	- Living off the Land.
- Evasi√≥n:
	- Bypass de detecci√≥n.
- Comunicaci√≥n:
	- C2 encubierto.
- Evaluaci√≥n:
	- Detecci√≥n Blue Team.

## Playbooks de Reporting y Remediaci√≥n

### Playbook de Cierre de Pentest
- Consolidar hallazgos.
- Validar impacto real.
- Clasificar riesgos.
- Preparar entregables.
- Reuni√≥n de cierre.

### Playbook de Remediaci√≥n
- Priorizaci√≥n:
	- Riesgo cr√≠tico primero.
- Acciones:
	- Parches, hardening.
- Validaci√≥n:
	- Re‚Äëtesting.
- Documentaci√≥n:
	- Evidencia de correcci√≥n.

## Uso Pr√°ctico
- Estas plantillas permiten:
	- Estandarizar pentests.
	- Acelerar proyectos.
	- Facilitar trabajo Red Team / Blue Team.
- Los playbooks sirven como:
	- Gu√≠a operativa reutilizable.
	- Base para ejercicios Purple Team.
	- Soporte para auditor√≠as y compliance.

