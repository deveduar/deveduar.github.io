creation date: 2025-04-17 18:43
tags:
  - gulp
  - compilacion
  - runners
keywords:
source:
status: 
Parent: "Area-Prog"
cssclasses:
  - hide-embedded-header1
  - wide
categories: "[Automatizacion y Build](/automatizacion%20y%20build/automatizacion-y-build/)"
public_note: "true"
# Gulp
``

- [Automatizacion y Build](/automatizacion%20y%20build/automatizacion-y-build/)
- Automatizacion
- [javascript](/desarrollo%20web/javascript/)
- Automatizar workflows JS

## Qu茅 es Gulp

Gulp es un **task runner basado en JavaScript** que permite automatizar tareas comunes de desarrollo web como:

- Minificaci贸n de archivos CSS y JS
- Compilaci贸n de preprocesadores (Sass, LESS)
- Optimizaci贸n de im谩genes
- Recarga autom谩tica del navegador
- Concatenaci贸n de archivos
- Copiado de archivos entre carpetas
- Limpieza de directorios de build

Se integra f谩cilmente con proyectos Node.js mediante un archivo `gulpfile.js`.

## Instalaci贸n

{% raw %}
```bash
npm install --global gulp-cli
npm install --save-dev gulp
```
{% endraw %}`

* `gulp-cli` permite ejecutar Gulp desde la l铆nea de comandos.
* `gulp` se instala localmente en el proyecto para definir tareas.

## Estructura b谩sica de gulpfile.js

{% raw %}
```javascript
const { src, dest, series, parallel, watch } = require('gulp');
const sass = require('gulp-sass')(require('sass'));
const cleanCSS = require('gulp-clean-css');
const uglify = require('gulp-uglify');

function css() {
	return src('src/scss/**/*.scss')
		.pipe(sass().on('error', sass.logError))
		.pipe(cleanCSS())
		.pipe(dest('dist/css'));
}

function js() {
	return src('src/js/**/*.js')
		.pipe(uglify())
		.pipe(dest('dist/js'));
}

function watchFiles() {
	watch('src/scss/**/*.scss', css);
	watch('src/js/**/*.js', js);
}

exports.default = series(
	parallel(css, js),
	watchFiles
);
```
{% endraw %}

## Conceptos clave

* **src**: Define los archivos de entrada.
* **dest**: Define la carpeta de salida.
* **pipe()**: Encadena transformaciones sobre los archivos.
* **task**: Funci贸n que realiza una acci贸n espec铆fica.
* **series()**: Ejecuta tareas de forma secuencial.
* **parallel()**: Ejecuta tareas de forma concurrente.
* **watch()**: Observa cambios en archivos y ejecuta tareas autom谩ticamente.

## Plugins comunes

* `gulp-sass`: Compila Sass a CSS.
* `gulp-clean-css`: Minifica CSS.
* `gulp-uglify`: Minifica JS.
* `gulp-imagemin`: Optimiza im谩genes.
* `gulp-concat`: Combina m煤ltiples archivos en uno.
* `browser-sync`: Recarga autom谩tica del navegador durante desarrollo.

## Flujo recomendado de trabajo

1. Definir tareas para cada tipo de archivo (CSS, JS, im谩genes).
2. Encadenar tareas mediante `series` o `parallel`.
3. Usar `watch` para desarrollo en tiempo real.
4. Generar builds de producci贸n optimizados con minificaci贸n y cache-busting.

## Recursos y documentaci贸n

* [Gulp.js Official Documentation](https://gulpjs.com/docs/en/getting-started/quick-start)
* Quick Start  gulp.js-quick-start
* [Automatizacion y Build](/automatizacion%20y%20build/automatizacion-y-build/)

# Gulp Avanzado

## Versiones y compatibilidad

- Gulp 4 es la versi贸n estable actual en 2025, con soporte completo para Node.js moderno.
- Cambios clave respecto a Gulp 3:
	tab	- Uso de `series` y `parallel` para tareas en vez de dependencias de strings.
	tab	- Mejor manejo de streams y errores.
	tab	- Eliminaci贸n de m茅todos obsoletos como `gulp.run()`.

## Manejo de errores

Evitar que Gulp se detenga en caso de error:

{% raw %}
```javascript
const plumber = require('gulp-plumber');

function css() {
	return src('src/scss/**/*.scss')
		.pipe(plumber())
		.pipe(sass())
		.pipe(dest('dist/css'));
}
```
{% endraw %}`

* `gulp-plumber` previene que el pipeline se rompa al encontrar errores.
* Permite mostrar logs claros en la consola para depuraci贸n r谩pida.

## Tareas condicionales

Permite ejecutar tareas solo si se cumplen condiciones:

{% raw %}
```javascript
const gulpIf = require('gulp-if');
const isProduction = process.env.NODE_ENV === 'production';

function js() {
	return src('src/js/**/*.js')
		.pipe(gulpIf(isProduction, uglify()))
		.pipe(dest('dist/js'));
}
```
{% endraw %}

* Ideal para diferenciar builds de desarrollo y producci贸n.
* Evita pasos innecesarios en entornos de desarrollo.

## Integraci贸n con frameworks modernos

* Angular, React, Vue: Gulp puede usarse para tareas auxiliares como optimizaci贸n de assets o compilaci贸n de CSS.
* En proyectos Node/Express se puede usar para preprocesar assets antes de servirlos.
* Compatible con TypeScript mediante `gulp-typescript`.

## Optimizaci贸n y performance

* Evitar recompilaciones completas con `gulp-cached` o `gulp-newer`:

{% raw %}
```javascript
const cached = require('gulp-cached');

function js() {
	return src('src/js/**/*.js')
		.pipe(cached('js'))
		.pipe(uglify())
		.pipe(dest('dist/js'));
}
```
{% endraw %}

* Solo procesa archivos modificados, reduciendo tiempos de build.

## Comparativa con otras herramientas

* **Webpack**: orientado a bundling y m贸dulos JS, m谩s pesado para tareas simples.
* **Parcel / Vite**: zero-config, r谩pido, pero menos flexible para pipelines complejos.
* **npm scripts**: 煤til para tareas simples, pero no ofrece streams ni encadenamiento avanzado.

Gulp sigue siendo relevante para proyectos que requieren pipelines personalizadas y control fino sobre cada etapa del build.

## Recursos adicionales

* [Gulp Recipes](https://gulpjs.com/docs/en/getting-started/recipes)
* [Integraci贸n con TypeScript](https://www.npmjs.com/package/gulp-typescript)
* Automatizacion
* [javascript](/desarrollo%20web/javascript/)
* [Automatizacion y Build](/automatizacion%20y%20build/automatizacion-y-build/)


# Gulp Casos Pr谩cticos y Ejemplos Completos

## Pipeline completo Frontend (CSS + JS + im谩genes)

### Descripci贸n del caso
Automatizaci贸n completa de un proyecto frontend cl谩sico:
- Compilaci贸n y minificaci贸n de Sass
- Minificaci贸n de JavaScript
- Optimizaci贸n de im谩genes
- Build listo para producci贸n

## C贸digo: Pipeline Frontend Completo

{% raw %}
```javascript
const { src, dest, series, parallel } = require('gulp');
const sass = require('gulp-sass')(require('sass'));
const cleanCSS = require('gulp-clean-css');
const uglify = require('gulp-uglify');
const imagemin = require('gulp-imagemin');
const del = require('del');

function clean() {
	return del(['dist']);
}

function css() {
	return src('src/scss/**/*.scss')
		.pipe(sass())
		.pipe(cleanCSS())
		.pipe(dest('dist/css'));
}

function js() {
	return src('src/js/**/*.js')
		.pipe(uglify())
		.pipe(dest('dist/js'));
}

function images() {
	return src('src/images/**/*')
		.pipe(imagemin())
		.pipe(dest('dist/images'));
}

exports.build = series(
	clean,
	parallel(css, js, images)
);
```
{% endraw %}`

## Desarrollo con Watch y Live Reload

### Descripci贸n del caso

Automatizar desarrollo con:

* Watch de archivos
* Recarga autom谩tica del navegador
* Servidor local

## C贸digo: Watch + BrowserSync

{% raw %}
```javascript
const { src, dest, watch, series } = require('gulp');
const browserSync = require('browser-sync').create();

function serve() {
	browserSync.init({
		server: {
			baseDir: './'
		}
	});
}

function reload(done) {
	browserSync.reload();
	done();
}

function watchFiles() {
	watch('src/scss/**/*.scss', series(css, reload));
	watch('src/js/**/*.js', series(js, reload));
	watch('*.html', reload);
}

exports.dev = series(
	css,
	js,
	serve,
	watchFiles
);
```
{% endraw %}

## Build Desarrollo vs Producci贸n

### Descripci贸n del caso

Separar comportamientos seg煤n entorno:

* Desarrollo: sin minificar
* Producci贸n: optimizado

## C贸digo: Build Condicional por Entorno

{% raw %}
```javascript
const gulpIf = require('gulp-if');
const isProduction = process.env.NODE_ENV === 'production';

function cssEnv() {
	return src('src/scss/**/*.scss')
		.pipe(sass())
		.pipe(gulpIf(isProduction, cleanCSS()))
		.pipe(dest('dist/css'));
}

function jsEnv() {
	return src('src/js/**/*.js')
		.pipe(gulpIf(isProduction, uglify()))
		.pipe(dest('dist/js'));
}

exports.build = parallel(cssEnv, jsEnv);
```
{% endraw %}

## Copiado y gesti贸n de assets est谩ticos

### Descripci贸n del caso

Mover archivos que no requieren procesamiento:

* Fuentes
* Archivos JSON
* Archivos est谩ticos

## C贸digo: Copiado de Assets

{% raw %}
```javascript
function assets() {
	return src('src/assets/**/*')
		.pipe(dest('dist/assets'));
}

exports.assets = assets;
```
{% endraw %}

## Integraci贸n con TypeScript

### Descripci贸n del caso

Compilaci贸n de TypeScript dentro del pipeline Gulp.

## C贸digo: Gulp con TypeScript

{% raw %}
```javascript
const ts = require('gulp-typescript');
const tsProject = ts.createProject('tsconfig.json');

function typescript() {
	return tsProject.src()
		.pipe(tsProject())
		.pipe(dest('dist/js'));
}

exports.ts = typescript;
```
{% endraw %}

## Optimizaci贸n incremental de builds

### Descripci贸n del caso

Reducir tiempos de build procesando solo archivos modificados.

## C贸digo: Build Incremental

{% raw %}
```javascript
const newer = require('gulp-newer');

function jsIncremental() {
	return src('src/js/**/*.js')
		.pipe(newer('dist/js'))
		.pipe(uglify())
		.pipe(dest('dist/js'));
}

exports.js = jsIncremental;
```
{% endraw %}

## Automatizaci贸n como paso previo a frameworks modernos

* Uso de Gulp como pre-build antes de:
  tab	- React
  tab	- Angular
  tab	- Vue
* Ideal para:
  tab	- Procesamiento avanzado de assets
  tab	- Legacy projects
  tab	- Migraciones progresivas

## Casos de uso reales

* Proyectos legacy sin bundler moderno
* Librer铆as internas con pipelines personalizados
* Sitios est谩ticos con optimizaci贸n avanzada
* Automatizaci贸n de tareas repetitivas fuera del scope de Webpack/Vite

