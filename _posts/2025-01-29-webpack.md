---
date: 2025-01-29 01:58
title: webpack
keywords:
source:
status: üåü
Parent: "[[Area-Prog]]"
public_note: "true"
category: Automatizacion y Build
tags:
  - webpack
---
# webpack

- [Automatizacion y Build](/automatizacion%20y%20build/automatizacion-y-build/)
- [Getting Started | webpack](https://webpack.js.org/guides/getting-started/)

## Conceptos base
- **Entry**  
	Entrada principal del bundle. Puede ser un solo archivo o m√∫ltiples puntos de entrada para dividir la aplicaci√≥n.
- **Output**  
	Define d√≥nde se almacena el bundle final, normalmente en `./dist`. El objeto `output` permite definir `path`, `filename` y m√°s.
- **Path library**  
	Uso del m√≥dulo nativo `path` de Node.js para resolver rutas absolutas en la configuraci√≥n:
	{% raw %}
```js
	const path = require('path');
	```
{% endraw %}
- **Loaders**  
	Piezas clave para transformar archivos: JS moderno, CSS, im√°genes, fuentes, TypeScript, Vue, React, etc.
- **Plugins**  
	Extienden capacidades del bundler: optimizaci√≥n, HTML autom√°tico, limpieza del directorio `dist`, variables de entorno, an√°lisis del bundle.
- **Dev Server**  
	Servidor de desarrollo con recarga en caliente y proxy. √ötil para DX y flujos SPA.
- **Minificaci√≥n y Uglify**  
	Optimizaci√≥n del c√≥digo en modo producci√≥n: minificaci√≥n JS, compresi√≥n de CSS, tree-shaking, eliminaci√≥n de c√≥digo muerto.

## Configuraci√≥n m√≠nima
- Ejemplo simplificado de `webpack.config.js`:
	{% raw %}
```js
	const path = require('path');

	module.exports = {
		entry: './src/index.js',
		output: {
			filename: 'bundle.js',
			path: path.resolve(__dirname, 'dist')
		}
	};
	```
{% endraw %}

## Loaders comunes
- **babel-loader**  
	Transpile moderno ‚Üí ES5. Requiere `.babelrc` o config en package.json.
- **css-loader y style-loader**  
	Permiten usar CSS dentro de JS.  
	{% raw %}
```js
	module.exports = {
		module: {
			rules: [
				{ test: /\.css$/, use: ['style-loader', 'css-loader'] }
			]
		}
	};
	```
{% endraw %}
- **file-loader / asset modules**  
	Manejo de im√°genes, fuentes y otros archivos. Webpack 5 usa m√≥dulos `asset/resource`, `asset/inline`, etc.
- **ts-loader / babel con TS**  
	Compilar TypeScript directamente o v√≠a Babel para mejoras de rendimiento.

## Plugins esenciales
- **HtmlWebpackPlugin**  
	Genera un HTML e inyecta el bundle autom√°ticamente.
- **CleanWebpackPlugin**  
	Limpia `dist` antes de cada build.
- **DefinePlugin**  
	Inyectar variables de entorno en el c√≥digo.
- **MiniCssExtractPlugin**  
	Extrae CSS a archivos separados, √∫til en producci√≥n.
- **TerserWebpackPlugin**  
	Minificaci√≥n avanzada de JS (sustituto moderno de Uglify).

## Webpack Dev Server
- soporta:
	- recarga en caliente (HMR)
	- historyApiFallback para SPAs
	- proxy para APIs locales/remotas
	- compresi√≥n gzip
- ejemplo:
	{% raw %}
```js
	devServer: {
		static: './dist',
		open: true,
		hot: true,
		port: 3000
	}
	```
{% endraw %}

## Modos y optimizaci√≥n
- **Mode**  
	- `development`: sin minificaci√≥n, mejor debugging.  
	- `production`: activa tree-shaking, minify, scope-hoisting.  
- **Code splitting**  
	Divisi√≥n del c√≥digo en chunks din√°micos (`import()`), vendors y m√≥dulos compartidos.
- **Caching**  
	Usar `filename: '[name].[contenthash].js'` para cache optimizado.
- **Tree-shaking**  
	Remoci√≥n autom√°tica de imports no usados si los m√≥dulos son ES Modules.

## Arquitectura recomendada de proyecto
- `/src`  
	- `index.js` o `main.js`
	- componentes o m√≥dulos
	- archivos de estilos
- `/dist`  
	Generado autom√°ticamente.
- `webpack.config.js`  
	Config principal o dividida por entornos:
		- `webpack.common.js`
		- `webpack.dev.js`
		- `webpack.prod.js`

## Configuraci√≥n avanzada
- **Multiples entry points**  
	Para apps grandes o microfrontends.
- **DLL / Caching persistente**  
	Para acelerar builds.
- **Integraci√≥n con frameworks**  
	React, Vue, Svelte usando loaders espec√≠ficos.
- **Module Federation**  
	Arquitectura para microfrontends, compartir m√≥dulos entre aplicaciones.
- **Optimizaci√≥n de im√°genes**  
	Plugins espec√≠ficos para comprimir PNG, JPG, SVG.
- **Source Maps**  
	Diferentes niveles: `eval`, `source-map`, `cheap-module-source-map`.

## Scripts recomendados en package.json
{% raw %}
```json
{
	"scripts": {
		"start": "webpack serve --mode=development",
		"build": "webpack --mode=production"
	}
}
```
{% endraw %}

# webpack ‚Äì ampliaci√≥n de conceptos pendientes

## Arquitectura interna de webpack
- **Module Graph**  
	Estructura interna donde webpack representa cada archivo como un nodo y sus dependencias como aristas. Permite aplicar optimizaciones como tree-shaking y code splitting.
- **Chunking System**  
	Un ‚Äúchunk‚Äù es una agrupaci√≥n l√≥gica de m√≥dulos. Webpack decide qu√© m√≥dulos agrupa seg√∫n entradas, imports din√°micos, cache groups y reglas del optimizador.
- **Build Lifecycle**  
	Fases claves: inicializaci√≥n, creaci√≥n del grafo, optimizaci√≥n, compilaci√≥n final y emisi√≥n (`emit`). Plugins se enganchan mediante *hooks* en cualquiera de estas etapas.

## Profundizaci√≥n en Loaders
- **Pipeline de loaders**  
	Los loaders se ejecutan **en orden inverso** al que se declaran. El √∫ltimo carga, el primero transforma. Permite generar pipelines complejos (por ejemplo: TS ‚Üí Babel ‚Üí minificador).
- **Loaders as√≠ncronos**  
	Algunos loaders pueden ser async (`this.async()`), permitiendo operaciones de IO, optimizaciones o llamadas internas.
- **Resoluci√≥n avanzada**  
	Se puede configurar `resolve.extensions`, `alias`, `fallback`, para transformar c√≥mo se resuelven archivos en proyectos grandes o monorepos.

## Profundizaci√≥n en Plugins
- **Tapable y sistema de hooks**  
	Webpack usa la librer√≠a Tapable. Los plugins se conectan a eventos como `compile`, `emit`, `afterEmit`, `optimizeChunks`.  
	Esto permite modificar casi cualquier parte del proceso.
- **Plugins de an√°lisis**  
	Herramientas como *Bundle Analyzer* permiten visualizar el tama√±o de los m√≥dulos en forma de treemap.
- **Plugins de producci√≥n avanzada**  
	- Compresi√≥n Brotli y Gzip  
	- Pre-rendering (generar HTML est√°tico)  
	- Prefetch/Preload para optimizar carga inicial

## Optimizaci√≥n Avanzada
- **SplitChunks en profundidad**  
	Permite agrupar librer√≠as externas en `vendors`, crear cache groups personalizados, separar estilos, etc.
- **Runtime Chunk**  
	Extrae el runtime de webpack a un archivo separado (`runtime.js`) para mejorar caching a largo plazo.
- **Layered Code Splitting**  
	Divisi√≥n basada en rutas, caracter√≠sticas, idioma o entorno.
- **SideEffects flag**  
	Los paquetes pueden declarar `"sideEffects": false` en `package.json` para ayudar a eliminar c√≥digo muerto.
- **Deterministic Chunk IDs**  
	Controla la estabilidad de los nombres de chunks para builds consistentes.

## Desarrollo profesional con Webpack
- **Configuraci√≥n monorepo**  
	Integraci√≥n con Yarn Workspaces o PNPM, aprovechando `resolve.alias`, rutas relativas al root y builds compartidos.
- **Empaquetado para librer√≠as**  
	Configuraci√≥n de `output.library`, `libraryTarget`, `externals` para crear librer√≠as compartibles (UMD, ESM, CommonJS).
- **Webpack y servidores backend**  
	Uso como middleware en Express (via webpack-dev-middleware) para SSR o aplicaciones universales.
- **Integraci√≥n con CI/CD**  
	Optimizaci√≥n de cach√© en pipelines, builds incrementales y comparaci√≥n de bundles entre versiones.

## Seguridad y control de entorno
- **Content Security Policy (CSP)**  
	Configuraci√≥n de hashes o nonces para trabajar con HTML generado autom√°ticamente.
- **Subresource Integrity (SRI)**  
	Plugins que generan integridad para proteger cargas de scripts desde CDN.
- **Variables de entorno**  
	Uso de DefinePlugin con `.env`, integraciones con dotenv, dotenv-expand y sistemas de secretos.

## Workflows avanzados
- **Babel + Webpack + SWC/Esbuild h√≠brido**  
	Usar esbuild-loader o swc-loader para acelerar la transformaci√≥n JS/TS.
- **Lazy Compilation (webpack 5)**  
	Compilaci√≥n bajo demanda: solo se compilan m√≥dulos cuando realmente se necesitan durante el desarrollo.
- **Module Federation avanzado**  
	Compartici√≥n din√°mica de m√≥dulos entre m√∫ltiples aplicaciones, con manejo de versiones, fallback remoto y cache local.

## Debugging y herramientas
- **Profiling**  
	Generaci√≥n de perfiles (`--profile`) para detectar cuellos de botella.
- **Stats JSON**  
	Permite exportar el grafo completo y analizarlo externamente.
- **Log levels**  
	Control detallado de logs: `info`, `warn`, `error`, `verbose`.

## Patrones y mejores pr√°cticas
- **Separaci√≥n completa de entornos**  
	- `webpack.common.js`
	- `webpack.dev.js`
	- `webpack.prod.js`
	- `webpack.analyze.js` (opcional)
- **Evitar entry points enormes**  
	Promover imports din√°micos, modularidad y chunks por ruta.
- **Usar assets modernos**  
	Preferir `asset modules` en vez de file-loader/url-loader.
- **Persistencia de caching**  
	Cache de filesystem incorporado en webpack 5 para builds m√°s r√°pidos.

## Integraci√≥n con frameworks y ecosistemas
- **React**  
	JSX, Fast Refresh con react-refresh-webpack-plugin, optimizaci√≥n para producci√≥n con splits.
- **Vue**  
	Uso de vue-loader, integraci√≥n con SFCs, HMR nativo.
- **Svelte**  
	svelte-loader para compilar componentes a JS vanilla.
- **SSR y prerender**  
	Webpack puede servir como base para SSR con frameworks propios o setups personalizados.

## Extensi√≥n estructural del proyecto
- **Aliases**  
	Definir rutas cortas (`@components`, `@utils`) para mejorar mantenibilidad.
- **M√≥dulos externos**  
	Control de qu√© dependencias no deben incluirse en el bundle final para librer√≠as o microfrontends.
- **Compatibilidad con navegadores**  
	`browserslist`, targets espec√≠ficos, polyfills autom√°ticos o manuales.

# webpack ‚Äì novedades y detalles actualizados a 2025

## Estado actual y versiones recientes  
- webpack sigue vivo: la versi√≥n m√°s reciente estable en 2025 es **5.102.1**.  
- El repositorio de cambios de webpack 5 (changelog-v5) qued√≥ archivado en febrero de 2025 

## Cambios recientes en webpack 5 (importantes hoy)  
- IDs deterministas por defecto para m√≥dulos y chunks en producci√≥n (`chunkIds: "deterministic"`, `moduleIds: "deterministic"`, `mangleExports: "deterministic"`) ayudan a **cache a largo plazo**.  
- En modo desarrollo, chunk IDs ‚Äúnombrados‚Äù (`chunkIds: "named"`) permiten que los bundles tengan nombres legibles, √∫til para debugging. 
- Module Federation: permite que m√∫ltiples builds independientes compartan m√≥dulos din√°micamente en runtime ‚Äî ideal para arquitecturas de micro-frontends. 
- webpack 5 incluye soporte nativo a m√≥dulos de tipo ‚Äúasset modules‚Äù ‚Äî ya no es obligatorio usar loaders externos para im√°genes, fuentes, etc. 
- Se alinea con nuevas caracter√≠sticas modernas de la web: uso de `import.meta.url`, soporte para carga de Web Workers v√≠a `new URL("./worker.js", import.meta.url)`, etc.  

## Ecosistema: evoluci√≥n de Module Federation  
- En abril de 2024 se anunci√≥ la **versi√≥n 2.0 de Module Federation**: ahora el runtime se ha extra√≠do como SDK independiente, lo que permite cargar m√≥dulos remotos en runtime sin depender estrictamente de webpack u otra herramienta de build.  
- Esto abre la puerta a combinaciones entre diferentes bundlers/compiladores (no s√≥lo webpack), lo que favorece flexibilidad y compatibilidad en arquitecturas modernas.  
- Es √∫til para escenarios avanzados: micro-frontends, carga din√°mica de m√≥dulos, lazy loading compartido, versiones compartidas de librer√≠as entre apps, sin recompilar todo.  

## Implicaciones para proyectos nuevos o en mantenimiento (2025)  
- Si usas webpack 5 en producci√≥n ‚Äî acepta **IDs deterministas** para mejorar caching.  
- Evita asumir polyfills autom√°ticos de m√≥dulos de Node.js: dado que webpack ya no los incluye por defecto, si necesitas compatibilidad con algunos m√≥dulos ‚Äúcore‚Äù, debes configurar `resolve.fallback` u otras alternativas.  
- Para arquitecturas modernas con micro-frontends o compartici√≥n de librer√≠as entre apps, considerar el uso de Module Federation (ideal con la versi√≥n 2.0) como estrategia de modularizaci√≥n.  
- Aprovechar asset modules nativos para gestionar im√°genes, fuentes, otros recursos ‚Äî simplifica configuraci√≥n y reduce dependencia de loaders extras.  

## Recursos oficiales / actualizados  
- [Module Federation | webpack](https://webpack.js.org/concepts/module-federation/) ‚Äî documentaci√≥n oficial de Module Federation.  
- [webpack / changelog-v5](https://github.com/webpack/changelog-v5) ‚Äî historial de cambios (aunque el repo est√° archivado, sigue siendo referencia principal para cambios desde webpack 4 ‚Üí 5).  
- [What‚Äôs New in webpack 5](https://deepwiki.com/webpack/changelog-v5/1.1-what%27s-new-in-webpack-5) ‚Äî resumen de las novedades principales.  

## Qu√© considerar mirar si est√°s empezando ahora con webpack en 2025  
- Configurar correctamente caching, hashing y nombres de chunks para producci√≥n.  
- Revisar compatibilidad de m√≥dulos Node.js si los necesitas.  
- Evaluar si conviene usar Module Federation, especialmente si planeas micro-frontends o varias apps compartiendo c√≥digo.  
- Aprovechar asset modules nativos.  
- Mantener webpack actualizado (versi√≥n 5.100+ en adelante).  

