---
date: 2025-05-21 04:05
title: cron jobs
keywords:
source:
status: üåü
Parent: "[[Area-Prog]]"
public_note: "true"
category: cron_jobs
tags:
  - cron_jobs
  - automatizacion
  - Backend
---
# cron jobs
``$= dv.current().file.tags.join(" ")``

## Herramientas √∫tiles
- Crontab.guru - The cron schedule expression generator
	- Generador y validador visual de expresiones cron
	- [Crontab.guru](https://crontab.guru)

## Documentaci√≥n y recursos
- ¬øQu√© son los Cron Jobs y para qu√© sirven - cdmon-que-son-los-cron-jobs-y-para-que-sirven
- Cron Job una gu√≠a completa para principiantes-cron-job12_Ejemplos_de_sintaxis_de_Cron
## Contexto y relaci√≥n con el ecosistema
- [Automatizacion y Build](/uncategorized/automatizacion-y-build/)
- Automatizacion
- [Backend](/uncategorized/backend/)
- [devops](/uncategorized/devops/)

Los **cron jobs** son una pieza fundamental en sistemas Unix/Linux para la **ejecuci√≥n autom√°tica de tareas programadas**. Se integran de forma natural en flujos de **automatizaci√≥n**, **operaciones backend** y **DevOps**, permitiendo ejecutar procesos sin intervenci√≥n humana en momentos espec√≠ficos o de forma recurrente.

## ¬øQu√© es cron?
**cron** es un **demonio del sistema** que se ejecuta en segundo plano y se encarga de lanzar tareas (jobs) seg√∫n una planificaci√≥n definida por el usuario.

- Funciona a nivel de sistema operativo.
- Lee configuraciones desde archivos llamados **crontabs**.
- Es extremadamente ligero, estable y disponible por defecto en la mayor√≠a de distribuciones Linux y Unix.

## ¬øQu√© es un cron job?
Un **cron job** es una **tarea programada** que cron ejecuta autom√°ticamente cuando se cumple una condici√≥n temporal.

- Puede ejecutar:
	- Comandos de shell
	- Scripts (bash, python, node, php, etc.)
	- Binarios del sistema
- Se define mediante una **expresi√≥n de tiempo + comando**
- Puede pertenecer a:
	- Un usuario concreto
	- El sistema (cron del sistema)

## Casos de uso habituales
- Backups autom√°ticos de bases de datos
- Limpieza de archivos temporales o logs
- Ejecuci√≥n de ETLs y procesos batch
- Env√≠o de emails programados
- Sincronizaci√≥n de datos con APIs externas
- Tareas de mantenimiento (rotaci√≥n de logs, chequeos)
- Builds nocturnos o tareas de integraci√≥n
- Ejecuci√≥n de scripts de scraping peri√≥dicos

## Crontab
La **crontab** es el archivo donde se definen los cron jobs.

- Cada usuario puede tener su propia crontab
- El sistema tambi√©n tiene crontabs globales
- Se edita normalmente con:
	- `crontab -e`
- Se lista con:
	- `crontab -l`

### Ubicaciones comunes
- `/var/spool/cron/`
- `/etc/crontab`
- `/etc/cron.d/`
- `/etc/cron.daily/`
- `/etc/cron.hourly/`
- `/etc/cron.weekly/`
- `/etc/cron.monthly/`

## Sintaxis de cron
Una expresi√≥n cron est√°ndar tiene **cinco campos de tiempo** seguidos del comando:

{% raw %}
```

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ minuto (0 - 59)  
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ hora (0 - 23)  
‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ d√≠a del mes (1 - 31)  
‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ mes (1 - 12)  
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ d√≠a de la semana (0 - 7) (domingo = 0 o 7)  
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ

- - - - - comando
                    

```
{% endraw %}

### Valores permitidos
- `*` ‚Üí cualquier valor
- `,` ‚Üí lista de valores
- `-` ‚Üí rango
- `/` ‚Üí pasos o intervalos

## Ejemplos de expresiones cron
- Ejecutar cada minuto:
	- `* * * * *`
- Ejecutar cada d√≠a a las 02:00:
	- `0 2 * * *`
- Ejecutar cada lunes a las 09:30:
	- `30 9 * * 1`
- Ejecutar cada 5 minutos:
	- `*/5 * * * *`
- Ejecutar el primer d√≠a de cada mes:
	- `0 0 1 * *`

## Variables de entorno en cron
Los cron jobs **no cargan el entorno completo del usuario**, lo que implica:

- PATH limitado
- Variables de entorno no disponibles
- No se ejecutan `.bashrc` o `.profile`

Buenas pr√°cticas:
- Usar rutas absolutas (`/usr/bin/python`)
- Definir variables expl√≠citamente
- Cargar un script que inicialice el entorno

Ejemplo:
{% raw %}
```

PATH=/usr/local/bin:/usr/bin:/bin

```
{% endraw %}

## Gesti√≥n de salida y logs
Por defecto:
- La salida est√°ndar y de error se env√≠an por email al usuario

Pr√°cticas comunes:
- Redirigir stdout y stderr a archivos de log
- Centralizar logs para depuraci√≥n

Ejemplo:
{% raw %}
```

0 2 * * * /script.sh >> /var/log/script.log 2>&1

```
{% endraw %}

## Permisos y seguridad
- El cron job se ejecuta con los **permisos del usuario** propietario
- Es cr√≠tico:
	- Validar scripts
	- Limitar permisos de escritura
	- Evitar ejecuci√≥n como root salvo necesidad

Archivos relevantes:
- `/etc/cron.allow`
- `/etc/cron.deny`

## Cron del sistema vs cron de usuario
### Cron de usuario
- Configurado con `crontab -e`
- M√°s sencillo
- Ideal para tareas personales o de aplicaciones

### Cron del sistema
- Definido en `/etc/crontab` o `/etc/cron.d`
- Incluye campo adicional de usuario
- Usado para tareas administrativas

## Cron y DevOps
En entornos modernos:
- Se usa cron para:
	- Jobs de mantenimiento
	- Orquestaci√≥n simple
- Se complementa o sustituye por:
	- Kubernetes CronJobs
	- CI/CD schedulers
	- Sistemas de colas y workers

Cron sigue siendo:
- Fiable
- Predecible
- F√°cil de auditar

## Limitaciones de cron
- No gestiona dependencias entre jobs
- No tiene control de estado ni reintentos
- No es adecuado para flujos complejos
- Dif√≠cil de escalar horizontalmente

## Buenas pr√°cticas
- Documentar cada cron job
- Usar scripts versionados
- A√±adir logs y alertas
- Evitar solapamiento de ejecuciones
- Probar manualmente antes de automatizar
- Revisar peri√≥dicamente jobs obsoletos

# cron jobs ‚Äî estado en 2025, recursos web y alternativas
``$= dv.current().file.tags.join(" ")``

## Estado de cron en 2025
En **2025**, cron sigue siendo una **herramienta vigente, estable y ampliamente usada** en sistemas Unix/Linux. A pesar del auge de plataformas cloud, orquestadores y sistemas distribuidos, cron mantiene su relevancia por su **simplicidad, fiabilidad y bajo coste operativo**.

- Presente por defecto en pr√°cticamente todas las distribuciones Linux
- M√≠nima sobrecarga de recursos
- Comportamiento predecible y bien conocido
- Ideal para:
	- Servidores tradicionales
	- VPS
	- M√°quinas on-premise
	- Automatizaciones simples y medianas

Cron no ha cambiado conceptualmente, pero **su rol ha evolucionado** dentro de arquitecturas modernas.

## Cron en arquitecturas modernas
En 2025 cron suele ocupar uno de estos roles:

- Automatizaci√≥n local en servidores
- Orquestaci√≥n b√°sica de scripts
- Lanzador de jobs que delegan trabajo a:
	- APIs
	- Colas de mensajes
	- Workers distribuidos
- Soporte a pipelines legacy

En muchos equipos:
- **cron = capa base**
- Herramientas modernas = capas superiores

## Ventajas que lo mantienen vigente
- Curva de aprendizaje m√≠nima
- No depende de terceros
- F√°cil de versionar indirectamente (infra como c√≥digo)
- Ideal para tareas deterministas
- Muy dif√≠cil de romper

## Limitaciones frente a soluciones modernas
- Sin gesti√≥n nativa de:
	- Retries
	- Estados
	- Dependencias
	- Observabilidad avanzada
- Escalado limitado
- Dif√≠cil de usar en entornos ef√≠meros (containers)

Estas limitaciones explican la aparici√≥n de **alternativas especializadas**.

## Recursos web actualizados
### Referencias oficiales
- [man cron](https://man7.org/linux/man-pages/man8/cron.8.html)
- [man crontab](https://man7.org/linux/man-pages/man5/crontab.5.html)

## Alternativas modernas a cron
### Kubernetes CronJobs
Pensado para entornos cloud-native.

- Ejecuci√≥n de jobs programados en clusters Kubernetes
- Escalado y aislamiento por contenedor
- Integraci√≥n con observabilidad y secrets

Caracter√≠sticas:
- Reemplazo natural de cron en clusters
- Gesti√≥n declarativa (YAML)
- Alta disponibilidad

## Schedulers en CI/CD
Herramientas como:
- GitHub Actions (scheduled workflows)
- GitLab CI Schedules
- Jenkins Scheduled Jobs

Uso t√≠pico:
- Builds nocturnos
- Tests peri√≥dicos
- Automatizaci√≥n de pipelines

Ventajas:
- Integraci√≥n con repositorios
- Logs centralizados
- Notificaciones autom√°ticas

## Orquestadores de workflows
### Apache Airflow
- DAGs complejos
- Dependencias expl√≠citas
- Ideal para data pipelines

### Prefect / Dagster
- Alternativas modernas a Airflow
- Mejor experiencia de desarrollo
- Observabilidad integrada

Adecuado cuando:
- Hay flujos complejos
- Existen dependencias temporales
- Se requiere reintento y control de estado

## Job schedulers distribuidos
- Nomad
- Celery Beat
- Quartz Scheduler

Usados cuando:
- Se necesita escalado horizontal
- Los jobs son distribuidos
- Hay alta frecuencia o carga

## Alternativas serverless
- AWS EventBridge + Lambda
- Google Cloud Scheduler
- Azure Logic Apps / Functions

Ventajas:
- Sin gesti√≥n de servidores
- Alta disponibilidad
- Pago por uso

Desventajas:
- Dependencia del proveedor
- Coste a largo plazo
- Menor control bajo nivel

## ¬øCu√°ndo usar cron en 2025?
Cron sigue siendo la mejor opci√≥n cuando:

- El entorno es simple
- La tarea es determinista
- No hay dependencias complejas
- Se ejecuta en un √∫nico host
- Se busca estabilidad y bajo mantenimiento

## ¬øCu√°ndo evitar cron?
Conviene evitarlo cuando:

- Hay flujos complejos
- Se requieren retries inteligentes
- Se necesita observabilidad avanzada
- El sistema es distribuido
- El entorno es altamente din√°mico

## Convivencia cron + alternativas
Patr√≥n com√∫n en 2025:
- cron lanza scripts ligeros
- scripts disparan jobs en:
	- Kubernetes
	- Airflow
	- APIs cloud
- cron act√∫a como disparador, no como orquestador

## Tendencia general
- cron **no desaparece**
- Se consolida como herramienta base
- Convive con sistemas m√°s avanzados
- Sigue siendo esencial en DevOps, backend y automatizaci√≥n

# cron jobs ‚Äî casos de uso completos y ejemplos de c√≥digo

## Relaci√≥n con el ecosistema
- [Automatizacion y Build](/uncategorized/automatizacion-y-build/)
- Automatizacion
- [Backend](/uncategorized/backend/)
- [devops](/uncategorized/devops/)

## Caso de uso: backup autom√°tico de base de datos
Escenario t√≠pico en backend y operaciones: generar copias de seguridad peri√≥dicas y almacenarlas de forma segura.

### Script de backup (bash)
{% raw %}
```bash
#!/bin/bash
DATE=$(date +"%Y-%m-%d_%H-%M")
BACKUP_DIR="/var/backups/mysql"
DB_NAME="app_db"
DB_USER="backup_user"

mkdir -p $BACKUP_DIR

/usr/bin/mysqldump -u $DB_USER $DB_NAME > $BACKUP_DIR/backup_$DATE.sql
```
{% endraw %}`

### Cron job asociado

{% raw %}
```cron
0 2 * * * /usr/local/bin/db_backup.sh >> /var/log/db_backup.log 2>&1
```
{% endraw %}

* Ejecuta todos los d√≠as a las 02:00
* Redirige logs para auditor√≠a
* Uso habitual en servidores on-premise o VPS

## Caso de uso: limpieza de archivos temporales

Mantenimiento autom√°tico para evitar consumo innecesario de disco.

### Script de limpieza

{% raw %}
```bash
#!/bin/bash
find /tmp/app-cache -type f -mtime +7 -delete
```
{% endraw %}

### Cron job asociado

{% raw %}
```cron
30 3 * * 0 /usr/local/bin/cleanup_tmp.sh
```
{% endraw %}

* Se ejecuta cada domingo a las 03:30
* Elimina archivos con m√°s de 7 d√≠as
* Muy com√∫n en entornos DevOps

## Caso de uso: ejecuci√≥n peri√≥dica de scraping

Uso frecuente en backend y automatizaci√≥n de datos.

### Script de scraping (Python)

{% raw %}
```python
import requests
from datetime import datetime

url = "https://api.example.com/data"
response = requests.get(url)

with open("/data/scraping/output.json", "w") as f:
	f.write(response.text)

print("Scraping ejecutado:", datetime.now())
```
{% endraw %}

### Cron job asociado

{% raw %}
```cron
*/15 * * * * /usr/bin/python3 /srv/scraping/scraper.py >> /var/log/scraper.log 2>&1
```
{% endraw %}

* Ejecuta cada 15 minutos
* Uso t√≠pico para:

  * ETLs
  * Agregaci√≥n de datos
  * Monitorizaci√≥n externa

## Caso de uso: env√≠o de emails programados

Automatizaci√≥n de notificaciones o reportes.

### Script de env√≠o (Node.js)

{% raw %}
```javascript
const nodemailer = require("nodemailer");

const transporter = nodemailer.createTransport({
	sendmail: true,
	newline: "unix",
	path: "/usr/sbin/sendmail"
});

transporter.sendMail({
	from: "noreply@app.com",
	to: "admin@app.com",
	subject: "Reporte diario",
	text: "El sistema sigue operativo."
});
```
{% endraw %}

### Cron job asociado

{% raw %}
```cron
0 8 * * 1-5 /usr/bin/node /srv/mail/daily_report.js
```
{% endraw %}

* Lunes a viernes a las 08:00
* Env√≠o autom√°tico de reportes
* Integraci√≥n sencilla con scripts existentes

## Caso de uso: build y tareas nocturnas

Automatizaci√≥n de procesos de build fuera de horario laboral.

### Script de build

{% raw %}
```bash
#!/bin/bash
cd /srv/app
/usr/bin/git pull origin main
/usr/bin/npm install
/usr/bin/npm run build
```
{% endraw %}

### Cron job asociado

{% raw %}
```cron
0 1 * * * /srv/app/nightly_build.sh >> /var/log/build.log 2>&1
```
{% endraw %}

* Build nocturno
* Reduce impacto en horas pico
* Muy usado antes de pipelines CI/CD completos

## Caso de uso: verificaci√≥n de salud del sistema

Chequeos simples sin necesidad de herramientas externas.

### Script de healthcheck

{% raw %}
```bash
#!/bin/bash
if ! systemctl is-active --quiet nginx; then
	echo "Nginx ca√≠do" | mail -s "ALERTA" admin@app.com
fi
```
{% endraw %}

### Cron job asociado

{% raw %}
```cron
*/5 * * * * /usr/local/bin/healthcheck.sh
```
{% endraw %}

* Ejecuta cada 5 minutos
* Env√≠a alerta si un servicio falla
* Alternativa ligera a sistemas de monitoring

## Caso de uso: sincronizaci√≥n de datos con API externa

Integraci√≥n peri√≥dica entre sistemas.

### Script de sincronizaci√≥n

{% raw %}
```bash
#!/bin/bash
curl -X POST https://api.partner.com/sync \
	-H "Authorization: Bearer TOKEN" \
	-d @/data/payload.json
```
{% endraw %}

### Cron job asociado

{% raw %}
```cron
0 */6 * * * /usr/local/bin/sync_partner.sh
```
{% endraw %}

* Cada 6 horas
* Integraci√≥n cl√°sica en backend empresarial

## Caso de uso: rotaci√≥n manual de logs

Complemento o alternativa a logrotate.

### Script de rotaci√≥n

{% raw %}
```bash
#!/bin/bash
LOG="/var/log/app/app.log"
ARCHIVE="/var/log/app/archive/app_$(date +%F).log"

mv $LOG $ARCHIVE
touch $LOG
```
{% endraw %}

### Cron job asociado

{% raw %}
```cron
0 0 * * * /usr/local/bin/rotate_logs.sh
```
{% endraw %}

* Rotaci√≥n diaria
* Control total sobre formato y nombres

## Patrones comunes en ejemplos reales

* Uso de rutas absolutas
* Redirecci√≥n de logs
* Scripts versionados
* Cron como disparador, no como l√≥gica compleja

## Herramientas de apoyo

* Crontab.guru - The cron schedule expression generator

  * [Crontab.guru](https://crontab.guru)
  * Validaci√≥n y pruebas de expresiones cron

## Buenas pr√°cticas aplicadas en los ejemplos

* Separar cron y l√≥gica de negocio
* Scripts peque√±os y testeables
* Logging expl√≠cito
* Frecuencias razonables
* Evitar solapamiento de ejecuciones

