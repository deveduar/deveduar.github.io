---
date: 2024-11-22 21:02
title: composer
tags:
  - PHP
keywords:
source:
status: üåü
Parent: "[[Area-Prog]]"
cssclasses:
  - hide-embedded-header1
  - wide
categories:
  - Backend
public_note: "true"
category: Backend
---
# composer
`$= dv.current().file.tags.join(" ")`

- [Automatizacion y Build](/uncategorized/automatizacion-y-build/)
- [Sistemas](/uncategorized/sistemas/)
- [PHP](/backend/php/)
- [Introduction - Composer](https://getcomposer.org/doc/00-intro.md)
- [Basic usage - Composer](https://getcomposer.org/doc/01-basic-usage.md)
- [Libraries - Composer](https://getcomposer.org/doc/02-libraries.md)

## Conceptos Fundamentales
- Gestor de paquetes
	- Administra dependencias externas de PHP.
	- Maneja versiones, compatibilidad y restricciones (semver).
	- Permite entornos reproducibles mediante `composer.lock`.
- Scripts
	- Automatizaci√≥n de tareas comunes (`post-install`, `pre-update`, comandos personalizados).
	- Integraci√≥n con herramientas CI/CD.
- Autoloading
	- Uso de PSR-4 y PSR-0.
	- Carga autom√°tica de clases sin `require` manual.
	- Integraci√≥n con namespaces.
- Comandos principales
	- `composer init` ‚Üí Crear `composer.json`.
	- `composer require` ‚Üí A√±adir dependencias.
	- `composer install` ‚Üí Instalar dependencias listadas.
	- `composer update` ‚Üí Actualizar dependencias.
	- `composer dump-autoload` ‚Üí Regenerar autoload.
- Mapeo de clases
	- Definici√≥n manual de directorios ‚Üí namespaces.
	- Configuraci√≥n de `autoload`:
		- `"psr-4"`
		- `"classmap"`
		- `"files"`
- Packages
	- Repositorios en Packagist.
	- Versiones y restricciones (`^`, `~`, `>=`, exactas).
	- Ejemplos:
		- monolog
		- [GitHub - Seldaek/monolog](https://github.com/Seldaek/monolog)
- Namespaces
	- Base para PSR-4.
	- Permite evitar colisiones de clases.
	- Facilita modularizaci√≥n y arquitectura limpia.

## Arquitectura y Flujos Internos
- `composer.json`
	- Metadatos del proyecto.
	- Dependencias, scripts, autoload, repositorios, configuraciones.
- `composer.lock`
	- Fijaci√≥n exacta de versiones.
	- Determinismo en despliegues.
- Vendor
	- Carpeta con dependencias instaladas.
	- Contiene autoloader generado.
- Repositorios
	- Packagist (principal).
	- Repos privados (Git, archivos locales, endpoints API).
- Resoluci√≥n de dependencias
	- Algoritmo SAT.
	- An√°lisis de compatibilidad.
	- Selecci√≥n √≥ptima de versiones seg√∫n restricciones.

## Ciclos de Trabajo Recomendados
- Proyecto nuevo
	- `composer init`
	- A√±adir dependencias base
	- Configurar autoload PSR-4
- Proyecto existente
	- `composer install`
	- Verificar `composer.lock`
- Producci√≥n
	- `composer install --no-dev --optimize-autoloader`
- Desarrollo
	- Scripts personalizados (ex.: testing, linting, build).
	- Autoload en modo desarrollo.

## Integraciones Comunes
- Frameworks
	- Laravel, Symfony, Slim, Lumen.
- Testing
	- PHPUnit, Pest.
- Quality Tools
	- PHPStan
	- Psalm
	- PHPCS
- Logs / Utilidades
	- Monolog
	- Dotenv
	- Carbon (fechas)

## Buenas Pr√°cticas
- Usar siempre `composer.lock` en producci√≥n.
- Especificar restricciones semver sensatas (`^` para libs nuevas, `~` para libs cr√≠ticas).
- No versionar la carpeta `vendor`.
- Mantener scripts organizados y con prop√≥sito claro.
- Evitar dependencias excesivas ‚Äî revisar impacto antes de incorporarlas.
- Separar dependencias `require` vs `require-dev`.

## Videos
- [Tutorial COMPLETO de Composer con PHP - YouTube](https://youtu.be/5n6Ta6NrXl0)
	- Namespaces
	- Uso pr√°ctico de PSR-4
	- Ejemplos reales de `composer.json`

## C√≥digo: Ejemplos de composer.json B√°sico
{% raw %}
```json
{
	"name": "miapp/proyecto",
	"description": "Ejemplo b√°sico",
	"require": {
		"monolog/monolog": "^3.0"
	},
	"autoload": {
		"psr-4": {
			"App\\": "src/"
		}
	}
}
```
{% endraw %}`

## C√≥digo: Scripts Personalizados

{% raw %}
```json
{
	"scripts": {
		"test": "phpunit",
		"lint": "phpcs --standard=PSR12 src"
	}
}
```
{% endraw %}

## C√≥digo: Autoload Avanzado con classmap

{% raw %}
```json
{
	"autoload": {
		"classmap": [
			"src/Legacy/"
		]
	}
}
```
{% endraw %}

## C√≥digo: Repositorio Privado

{% raw %}
```json
{
	"repositories": [
		{
			"type": "vcs",
			"url": "https://github.com/mi-org/mi-lib"
		}
	]
}
```
{% endraw %}

# Composer ‚Äî Glosario

## Conceptos Generales
- **Composer**  
	Gestor de dependencias para PHP que administra librer√≠as externas, versiones, scripts y el autoloading de clases.
- **Dependencia**  
	Paquete externo requerido por un proyecto para funcionar.
- **Packagist**  
	Repositorio principal de paquetes compatibles con Composer.
- **Semver (Versionado Sem√°ntico)**  
	Est√°ndar de versionado basado en `MAJOR.MINOR.PATCH`.

## Archivos Clave
- **composer.json**  
	Archivo de configuraci√≥n principal: define dependencias, scripts, autoload y metadatos del proyecto.
- **composer.lock**  
	Archivo generado autom√°ticamente que fija versiones exactas para garantizar reproducibilidad.
- **vendor/**  
	Directorio creado por Composer donde se almacenan todas las dependencias instaladas.

## Autoloading
- **PSR-4**  
	Est√°ndar de autoloading que mapea namespaces a directorios.
- **PSR-0**  
	Est√°ndar legado donde el nombre de la clase define su ruta de archivo.
- **classmap**  
	Mecanismo para mapear archivos o directorios completos a clases espec√≠ficas.
- **files autoload**  
	Permite cargar archivos PHP de forma autom√°tica sin uso de clases (ej. helpers).

## Comandos
- **composer init**  
	Inicializa un nuevo proyecto generando un `composer.json`.
- **composer require**  
	A√±ade una nueva dependencia al proyecto.
- **composer install**  
	Instala dependencias definidas en `composer.lock` o `composer.json`.
- **composer update**  
	Actualiza dependencias a las versiones permitidas.
- **composer dump-autoload**  
	Regenera el autoloader, √∫til despu√©s de cambios en clases.

## Scripts y Automatizaci√≥n
- **Scripts de Composer**  
	Tareas autom√°ticas configuradas en `composer.json` como `pre-install`, `post-update` o comandos personalizados.
- **Hooks**  
	Ejecuciones autom√°ticas disparadas por eventos internos de Composer.

## Paquetes y Versionado
- **Paquete (Package)**  
	Unidad de distribuci√≥n en Composer, definida por nombre, versi√≥n y metadatos.
- **Constraint de versi√≥n**  
	Restricciones usadas para seleccionar versiones compatibles (`^`, `~`, `>=`, `dev-master`, etc.).
- **Repositorios personalizados**  
	Fuentes alternativas a Packagist: Git, archivos locales, Satis, APIs.

## Integraciones
- **Monolog**  
	Paquete de logging muy popular en el ecosistema PHP.
- **PHPUnit / Pest**  
	Herramientas de testing com√∫nmente instaladas mediante Composer.
- **PHPStan / Psalm**  
	Herramientas de an√°lisis est√°tico integradas en el flujo mediante scripts.

## Arquitectura Interna
- **SAT Solver**  
	Algoritmo utilizado por Composer para resolver dependencias y compatibilidades.
- **Mini repositorio local**  
	Cach√© donde Composer guarda paquetes descargados para acelerar instalaciones posteriores.
- **Autoloader**  
	Archivo generado por Composer encargado de cargar clases autom√°ticamente (`vendor/autoload.php`).

## Buenas Pr√°cticas
- **No versionar vendor/**  
	La carpeta debe generarse siempre mediante `composer install`.
- **Usar requerimientos precisos**  
	Controlar actualizaciones inesperadas mediante restricciones de versi√≥n bien definidas.
- **Distribuir proyectos con composer.lock**  
	Especialmente importante en producci√≥n.
- **Separar dependencias de producci√≥n y desarrollo**  
	Usar `require` vs `require-dev`.

