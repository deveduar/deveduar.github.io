---
date: 2025-04-14 03:33
title: OWASP
tags:
  - Hacking
  - owasp
keywords:
source:
status: üåü
Parent: "[[Area-Sistemas]]"
cssclasses:
  - hide-embedded-header1
categories:
  - ciberseguridad
public_note: "true"
category: ciberseguridad
---
# OWASP
``$= dv.current().file.tags.join(" ")``

## Relaci√≥n con Pentesting
- [Pentesting](/ciberseguridad/pentesting/)
	- OWASP act√∫a como marco de referencia principal para pruebas de seguridad en aplicaciones web
	- Proporciona metodolog√≠as, gu√≠as y est√°ndares usados en auditor√≠as t√©cnicas y pruebas de intrusi√≥n
	- Complementa otras metodolog√≠as como [OSSTMM](/ciberseguridad/osstmm/) y PTES
	- Base habitual para certificaciones, laboratorios y ejercicios tipo CTF enfocados a aplicaciones web

## Qu√© es OWASP
- Open Worldwide Application Security Project
- Comunidad abierta y sin √°nimo de lucro centrada en la seguridad de aplicaciones
- Produce documentaci√≥n, est√°ndares, herramientas y proyectos abiertos
- Enfoque pr√°ctico orientado a:
	- Prevenci√≥n de vulnerabilidades
	- Detecci√≥n temprana
	- Mejora del ciclo de desarrollo seguro (SSDLC)

- Recursos introductorios:
	- [¬øQu√© es OWASP? ¬øQu√© es OWASP TOP 10? | Blog de Arsys](https://www.arsys.es/blog/owasp)
	- [¬øQu√© es OWASP? OWASP Top 10 de vulnerabilidades y riesgos | F5](https://www.f5.com/es_es/glossary/owasp)

## Metodolog√≠a OWASP
- metodologia
	- OWASP no es una metodolog√≠a cerrada, sino un conjunto de gu√≠as modulares
	- Se adapta a:
		- Tipo de aplicaci√≥n (web, API, m√≥vil)
		- Fase del ciclo de vida (dise√±o, desarrollo, testing, producci√≥n)
	- Basada en:
		- Identificaci√≥n de activos
		- Modelado de amenazas
		- Enumeraci√≥n de superficies de ataque
		- Validaci√≥n t√©cnica mediante pruebas

- Relaci√≥n directa con:
	- testing
	- [vulnerabilidades](/ciberseguridad/vulnerabilidades/)

## Principios de Seguridad OWASP
- [OWASP Security Principles](https://owasp.org/www-project-proactive-controls/)
	- Seguridad por dise√±o (Secure by Design)
	- Defensa en profundidad
	- Principio de m√≠nimo privilegio
	- Validaci√≥n de entradas y salidas
	- Autenticaci√≥n y autorizaci√≥n robustas
	- Manejo seguro de errores y logs
	- Uso seguro de criptograf√≠a
	- Actualizaci√≥n y gesti√≥n de dependencias

- Enfoque preventivo:
	- Pensado para desarrolladores y arquitectos
	- Reduce costes frente a correcciones en producci√≥n

## OWASP Cheat Sheet Series
- [Introduction - OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/index.html)
	- Gu√≠as pr√°cticas y concisas
	- Orientadas a problemas concretos
	- Uso directo en desarrollo y hardening

- Ejemplos de tem√°ticas:
	- Authentication Cheat Sheet
	- Session Management Cheat Sheet
	- SQL Injection Prevention
	- XSS Prevention
	- REST Security Cheat Sheet
	- JWT Security Cheat Sheet

- Uso recomendado:
	- Checklists de seguridad
	- Referencia r√°pida durante auditor√≠as
	- Apoyo en revisiones de c√≥digo

## OWASP Top 10
- Proyecto m√°s conocido de OWASP
- Lista de las 10 categor√≠as de riesgos m√°s cr√≠ticos
- Basado en:
	- Frecuencia
	- Impacto
	- Explotabilidad
- Actualizado peri√≥dicamente

- Relaci√≥n con:
	- [vulnerabilidades](/ciberseguridad/vulnerabilidades/)
	- Priorizaci√≥n de riesgos
	- Concienciaci√≥n ejecutiva y t√©cnica

## Modelado de Amenazas
- [Threat Modeling Process | OWASP Foundation](https://owasp.org/www-community/Threat_Modeling_Process)
	- Identificaci√≥n de activos
	- Identificaci√≥n de amenazas
	- Evaluaci√≥n de riesgos
	- Definici√≥n de mitigaciones
	- Validaci√≥n continua

- T√©cnicas comunes:
	- STRIDE
	- Diagramas de flujo de datos (DFD)
	- An√°lisis de superficies de ataque
	- Casos de abuso (abuse cases)

- Integraci√≥n con:
	- Dise√±o de aplicaciones
	- testing
	- Pentesting orientado a riesgos

## OWASP Web Security Testing Guide (WSTG)
- [WSTG - Stable | OWASP Foundation](https://owasp.org/www-project-web-security-testing-guide/stable/2-Introduction/README#The-OWASP-Testing-Project)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
	- Gu√≠a exhaustiva de pruebas de seguridad web
	- Orientada a pentesters y auditores
	- Estructurada por fases y categor√≠as

- Fases principales:
	- Information Gathering
	- Configuration and Deployment Management Testing
	- Identity Management Testing
	- Authentication Testing
	- Authorization Testing
	- Session Management Testing
	- Input Validation Testing
	- Error Handling
	- Cryptography
	- Business Logic Testing
	- Client-Side Testing

- Uso pr√°ctico:
	- Base para informes t√©cnicos
	- Creaci√≥n de checklists de auditor√≠a
	- Dise√±o de laboratorios y pr√°cticas

## Herramientas OWASP
- [Herramientas OWASP](https://owasp.org/www-community/Free_for_Open_Source_Application_Security_Tools)
	- Listado de herramientas gratuitas y open source
	- Clasificadas por tipo de uso

- Categor√≠as habituales:
	- DAST (ej. OWASP ZAP)
	- SAST
	- Dependency Scanning
	- Fuzzing
	- Threat Modeling
	- Secure Code Review

- Integraci√≥n com√∫n:
	- Pipelines CI/CD
	- Laboratorios de formaci√≥n
	- Auditor√≠as manuales y autom√°ticas

## OWASP y Testing Continuo
- testing
	- OWASP promueve testing continuo y automatizado
	- Integraci√≥n temprana en el ciclo de desarrollo
	- Reducci√≥n de vulnerabilidades repetitivas

- Enfoque [DevSecOps](/devops/devsecops/):
	- Shift Left Security
	- Automatizaci√≥n de controles
	- Concienciaci√≥n del equipo t√©cnico

# OWASP ‚Äî Conceptos y Proyectos Avanzados

## Est√°ndares de Verificaci√≥n OWASP (ASVS)
- OWASP Application Security Verification Standard
- Marco de control t√©cnico para validar seguridad en aplicaciones
- Define niveles de seguridad medibles y verificables

- Niveles ASVS:
	- Nivel 1: aplicaciones b√°sicas, bajo riesgo
	- Nivel 2: aplicaciones con datos sensibles
	- Nivel 3: aplicaciones cr√≠ticas o de alto impacto

- Uso pr√°ctico:
	- Base para requisitos de seguridad
	- Checklists de auditor√≠a
	- Contratos y SLAs de seguridad
	- Validaci√≥n de controles en testing

## OWASP SAMM (Software Assurance Maturity Model)
- Modelo de madurez en seguridad de software
- Orientado a organizaciones, no a aplicaciones individuales
- Eval√∫a procesos, no solo vulnerabilidades

- Dominios principales:
	- Governance
	- Design
	- Implementation
	- Verification
	- Operations

- Aplicaci√≥n:
	- Evaluaci√≥n del estado de seguridad
	- Roadmap de mejora progresiva
	- Integraci√≥n con DevSecOps
	- Complementa auditor√≠as t√©cnicas

## OWASP Proactive Controls
- Controles de seguridad prioritarios para desarrolladores
- Enfoque preventivo frente a reactivo
- Dise√±ados para reducir las causas ra√≠z de vulnerabilidades

- Controles destacados:
	- Validaci√≥n de entradas
	- Control de acceso consistente
	- Protecci√≥n de datos sensibles
	- Logging y monitoring
	- Manejo seguro de dependencias
	- Seguridad en configuraci√≥n

- Relaci√≥n con:
	- Secure Coding
	- Revisi√≥n de c√≥digo
	- Formaci√≥n t√©cnica

## OWASP API Security
- Proyecto espec√≠fico para APIs REST y GraphQL
- Complemento al OWASP Top 10 tradicional

- OWASP API Security Top 10:
	- Broken Object Level Authorization
	- Broken Authentication
	- Excessive Data Exposure
	- Lack of Resources & Rate Limiting
	- Broken Function Level Authorization
	- Mass Assignment
	- Security Misconfiguration
	- Injection
	- Improper Asset Management
	- Unsafe Consumption of APIs

- Enfoque:
	- Testing de APIs
	- Seguridad en microservicios
	- Arquitecturas modernas

## Seguridad en Aplicaciones M√≥viles
- OWASP Mobile Application Security
- Adaptaci√≥n de OWASP al entorno m√≥vil

- Proyectos clave:
	- OWASP MASVS (Mobile AppSec Verification Standard)
	- OWASP MSTG (Mobile Security Testing Guide)

- Cobertura:
	- Almacenamiento local
	- Comunicaci√≥n segura
	- Autenticaci√≥n m√≥vil
	- Protecci√≥n de c√≥digo
	- Reverse engineering

- Relaci√≥n con:
	- [Pentesting](/ciberseguridad/pentesting/) m√≥vil
	- Auditor√≠as Android / iOS

## Secure Software Development Lifecycle (SSDLC)
- OWASP promueve seguridad en todas las fases del SDLC
- No limitado a la fase de testing

- Fases cubiertas:
	- Requisitos de seguridad
	- Dise√±o seguro
	- Desarrollo seguro
	- Testing automatizado y manual
	- Despliegue seguro
	- Monitorizaci√≥n y respuesta

- Beneficios:
	- Reducci√≥n de riesgos tempranos
	- Menor coste de correcci√≥n
	- Mejora continua

## Gobierno y Gesti√≥n de Seguridad
- OWASP como soporte a governance
- Alineaci√≥n con:
	- Pol√≠ticas internas
	- Normativas
	- Auditor√≠as de cumplimiento

- Uso estrat√©gico:
	- Definici√≥n de pol√≠ticas AppSec
	- Evaluaci√≥n de riesgos
	- Concienciaci√≥n organizacional
	- M√©tricas de seguridad

## OWASP y [DevSecOps](/devops/devsecops/)
- Integraci√≥n de seguridad en pipelines [CICD](/devops/cicd/)
- Automatizaci√≥n de controles OWASP

- Pr√°cticas comunes:
	- SAST temprano
	- DAST continuo
	- Dependency scanning
	- Infraestructura como c√≥digo segura
	- Validaciones ASVS automatizadas

- Objetivo:
	- Seguridad como responsabilidad compartida
	- Feedback r√°pido
	- Reducci√≥n de vulnerabilidades recurrentes

## OWASP como Ecosistema
- OWASP no es solo Top 10
- Conjunto amplio de proyectos activos

- Tipos de proyectos:
	- Documentaci√≥n
	- Est√°ndares
	- Herramientas
	- Frameworks
	- Formaci√≥n

- Uso combinado:
	- Top 10 para concienciaci√≥n
	- WSTG para pruebas
	- ASVS para verificaci√≥n
	- SAMM para madurez
	- Cheat Sheets para ejecuci√≥n t√©cnica

# Recursos y Tools OWASP & Seguridad (2025)

## OWASP ‚Äî Repositorios y Listados Oficiales
- **[Herramientas OWASP (p√°gina oficial)](https://owasp.org/www-community/Free_for_Open_Source_Application_Security_Tools)**  
	- Listado curado de herramientas gratuitas y open source para seguridad de aplicaciones y testing  
	- Incluye SAST, DAST, IAST, dependencias, an√°lisis de c√≥digo y m√°s
- **[Gu√≠a del Desarrollador OWASP ‚Äì Herramientas de Verificaci√≥n](https://owasp.org/www-project-developer-guide/release-es/verificaci%C3%B3n/herramientas/)**  
	- Secci√≥n con herramientas de verificaci√≥n automatizadas y manuales  
	- Ejemplos: Amass, OWTF, OWASP Nettacker

## DAST / Dynamic Application Security Testing
- **[OWASP Zed Attack Proxy (ZAP)](https://www.zaproxy.org/)**  
	- Intercepting proxy + esc√°ner autom√°tico y manual para aplicaciones web  
	- Crawling, fuzzing, scripting e integraci√≥n CI/CD
- **[Akto](https://github.com/akto-api-security/akto)**  
	- DAST y API Security scanner open source  
	- Descubrimiento autom√°tico de endpoints y pruebas continuas
- **[Arachni](https://www.arachni-scanner.com/)**  
	- Esc√°ner web con testing activo y pasivo  
	- Framework extensible para auditor√≠as web
- **[Barrion](https://github.com/GoSecure/barrion)**  
	- Plataforma de escaneo web con informes y recomendaciones
- **[CI Fuzz CLI](https://github.com/code-intelligence-testing/cifuzz)**  
	- Herramienta de fuzzing integrada en pipelines de build
- **[StackHawk](https://www.stackhawk.com/)**  
	- Basado en OWASP ZAP  
	- DAST orientado a CI/CD con gesti√≥n centralizada de hallazgos

## SAST / Static Application Security Testing
- **[GitHub Code Scanning (CodeQL)](https://github.com/features/security)**  
	- SAST integrado en GitHub Actions  
	- Ideal para proyectos open source y privados
- **[Coverity Scan Static Analysis](https://scan.coverity.com/)**  
	- An√°lisis est√°tico multi-lenguaje  
	- Enfoque en defectos cr√≠ticos y seguridad
- **[Contrast CodeSec](https://www.contrastsecurity.com/codesec)**  
	- Esc√°ner SAST para c√≥digo y serverless  
	- Versi√≥n gratuita disponible
- **[GuardScan](https://github.com/GuardScan/guardscan)**  
	- SAST CLI open source  
	- OWASP Top 10, dependencias, secretos e IaC

## IAST & Integraci√≥n Continua
- **[Contrast Community Edition](https://www.contrastsecurity.com/community-edition)**  
	- IAST gratuito para Java y .NET  
	- Instrumentaci√≥n en tiempo real durante ejecuci√≥n

## Dependencias, SCA & Supply Chain
- **[OWASP Dependency Check](https://owasp.org/www-project-dependency-check/)**  
	- Escaneo de librer√≠as contra bases de datos de CVEs
- **[OWASP Dependency Track](https://owasp.org/www-project-dependency-track/)**  
	- Plataforma de gesti√≥n continua de riesgos en dependencias
- **[Dependabot](https://docs.github.com/en/code-security/dependabot)**  
	- Actualizaciones autom√°ticas de dependencias vulnerables
- **[Bytesafe Dependency Firewall](https://bytesafe.dev/)**  
	- Control de dependencias con pol√≠ticas de seguridad y licencias
- **[Debricked](https://debricked.com/)**  
	- Detecci√≥n y mitigaci√≥n de riesgos en open source
- **[Arnica](https://www.arnica.io/)**  
	- Dashboard unificado de riesgos de c√≥digo, SCA y secretos

## Code Quality y Linters Seguridad
- **[SpotBugs](https://spotbugs.github.io/) + [FindSecBugs](https://find-sec-bugs.github.io/)**  
	- An√°lisis de calidad y seguridad para Java
- **[SonarQube](https://www.sonarsource.com/products/sonarqube/)**  
	- Calidad de c√≥digo con reglas de seguridad OWASP
- **[DeepScan](https://deepscan.io/)**  
	- An√°lisis est√°tico para JavaScript y TypeScript
- **[MegaLinter](https://megalinter.io/)**  
	- M√°s de 100 linters para c√≥digo, seguridad, IaC y configuraciones

## Secret & Credential Detection
- **[Gitleaks](https://github.com/gitleaks/gitleaks)**  
	- Detecci√≥n de secretos en repositorios y commits
- **[detect-secrets](https://github.com/Yelp/detect-secrets)**  
	- Prevenci√≥n de inclusi√≥n de secretos en el c√≥digo
- **[TruffleHog](https://github.com/trufflesecurity/trufflehog)**  
	- Escaneo profundo de secretos en repos y artefactos
- **[GitGuardian / ggshield](https://www.gitguardian.com/ggshield)**  
	- Monitorizaci√≥n continua de secretos en repositorios
- **[Kingfisher](https://github.com/microsoft/kingfisher)**  
	- Detecci√≥n de secretos en repos, im√°genes y almacenamiento cloud

## Automatizaci√≥n & Remediaci√≥n
- **[Mobb](https://www.mobb.ai/)**  
	- Generaci√≥n autom√°tica de PRs para corregir vulnerabilidades
- **[Corgea](https://corgea.com/)**  
	- Detecci√≥n y correcci√≥n autom√°tica basada en SAST y SCA

## Otras Herramientas Relacionadas
- **[OpenVulnScan](https://github.com/sudofox/openvulnscan)**  
	- Plataforma ligera combinando Nmap, ZAP y CVEs
- **[WebVigil](https://github.com/webvigil/webvigil)**  
	- Toolkit open source de pentesting web orientado a OWASP Top 10
- **[Nmap](https://nmap.org/)**  
	- Descubrimiento y enumeraci√≥n de red
- **[OpenVAS / Greenbone](https://www.greenbone.net/)**  
	- Esc√°ner de vulnerabilidades de red y sistemas

## Categor√≠as OWASP Relevantes 2025
- **[OWASP Top 10 (2025)](https://owasp.org/Top10/)**  
	- Riesgos cr√≠ticos actualizados: Access Control, Misconfiguration, Supply Chain, etc.
- **[OWASP GenAI Security Projects](https://genai.owasp.org/)**  
	- Riesgos y mitigaciones para LLMs y aplicaciones de IA generativa

# OWASP ‚Äî Laboratorios Pr√°cticos (2025)

## Lista de Labs Propuestos
- Inyecci√≥n SQL cl√°sica y ciega
- Broken Access Control (IDOR)
- Autenticaci√≥n rota (fuerza bruta y bypass l√≥gico)
- XSS almacenado y reflejado
- CSRF en formularios cr√≠ticos
- File Upload inseguro
- Command Injection
- SSRF b√°sico a cloud metadata
- Deserializaci√≥n insegura
- Security Misconfiguration (headers, debug, backups)
- JWT mal configurado
- Business Logic Abuse
- Path Traversal
- Open Redirect

## Lab Desarrollado ‚Äî Broken Access Control (IDOR)

## Objetivo del Lab
- Identificar y explotar un fallo de control de acceso horizontal
- Acceder a recursos de otros usuarios modificando identificadores
- Relacionar el fallo con OWASP Top 10 y ASVS

## Escenario
- Aplicaci√≥n web con autenticaci√≥n
- Endpoint que devuelve datos de usuario por ID
- El backend no valida que el recurso pertenezca al usuario autenticado

## Arquitectura del Lab
- Frontend: HTML simple
- Backend: Node.js + Express
- Base de datos: JSON simulado
- Autenticaci√≥n: Cookie de sesi√≥n b√°sica

## Configuraci√≥n del Entorno
- Node.js >= 18
- npm
- Navegador + proxy (OWASP ZAP o Burp)

## Configuraci√≥n ‚Äî package.json
```json
{
	"name": "idor-lab",
	"version": "1.0.0",
	"main": "app.js",
	"dependencies": {
		"express": "^4.19.0",
		"cookie-parser": "^1.4.6"
	}
}
````

## Configuraci√≥n ‚Äî Base de Datos Simulada

```json
{
	"users": [
		{ "id": 1, "username": "alice", "email": "alice@lab.local", "role": "user" },
		{ "id": 2, "username": "bob", "email": "bob@lab.local", "role": "user" },
		{ "id": 3, "username": "admin", "email": "admin@lab.local", "role": "admin" }
	]
}
```

## Backend Vulnerable ‚Äî app.js

```js
const express = require("express");
const cookieParser = require("cookie-parser");
const users = require("./db.json").users;

const app = express();
app.use(cookieParser());

app.get("/login/:userId", (req, res) => {
	res.cookie("userId", req.params.userId);
	res.send("Login correcto");
});

app.get("/api/user/:id", (req, res) => {
	const user = users.find(u => u.id == req.params.id);
	if (!user) return res.status(404).send("No encontrado");
	res.json(user);
});

app.listen(3000, () => console.log("Lab IDOR en http://localhost:3000"));
```

## Paso a Paso de Explotaci√≥n

- Autenticarse como usuario normal
- Interceptar la petici√≥n leg√≠tima
- Modificar el identificador del recurso
- Obtener datos de otros usuarios

## Ejemplo ‚Äî Login como Usuario Normal

```http
GET /login/1 HTTP/1.1
Host: localhost:3000
```

## Ejemplo ‚Äî Petici√≥n Leg√≠tima

```http
GET /api/user/1 HTTP/1.1
Host: localhost:3000
Cookie: userId=1
```

## Ejemplo ‚Äî Explotaci√≥n IDOR

```http
GET /api/user/3 HTTP/1.1
Host: localhost:3000
Cookie: userId=1
```

## Impacto

- Acceso a informaci√≥n sensible
- Escalada horizontal
- Posible escalada vertical si se accede a usuarios privilegiados

## Detecci√≥n con OWASP ZAP

- Navegar autenticado
- Forzar browse manual
- Modificar par√°metros en el Request Editor
- Revisar respuestas 200 inesperadas

## Correcci√≥n ‚Äî Validaci√≥n de Propiedad

```js
app.get("/api/user/:id", (req, res) => {
	if (req.cookies.userId != req.params.id)
		return res.status(403).send("Acceso denegado");

	const user = users.find(u => u.id == req.params.id);
	res.json(user);
});
```

## Mejora Recomendada

- Control de acceso centralizado
- Uso de identificadores no predecibles
- Validaci√≥n de rol y ownership
- Auditor√≠a de endpoints seg√∫n ASVS

## Relaci√≥n OWASP

- OWASP Top 10: Broken Access Control
- ASVS: V4 Access Control
- WSTG: Authorization Testing