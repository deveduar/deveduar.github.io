creation date: 2025-01-29 14:04
tags:
  - swagger
  - api
  - documentacion
keywords:
source:
status: üåü
Parent: "Area-Prog"
cssclasses:
  - hide-embedded-header1
  - wide
categories: "[Backend](/backend/backend/)"
public_note: "true"
# swagger

- [OpenAPI](/backend/openapi/)
- [Testing](/testing/testing/)
- [api](/backend/api/)

## Concepto general
- **Swagger** es un conjunto de herramientas y especificaciones para **dise√±ar, documentar, probar y consumir [api](/backend/api/)**.
- Se basa en la **especificaci√≥n OpenAPI (OAS)**, est√°ndar abierto para describir APIs REST.
- Permite que humanos y m√°quinas entiendan la API **sin acceder al c√≥digo fuente**.
- Facilita la comunicaci√≥n entre **backend, frontend, QA, DevOps y clientes externos**.

## Relaci√≥n con OpenAPI
- Swagger fue el **origen hist√≥rico** de OpenAPI.
- Actualmente:
	- **OpenAPI** = especificaci√≥n
	- **Swagger** = ecosistema de herramientas que implementan OpenAPI
- Un archivo OpenAPI (`openapi.yaml` o `openapi.json`) es el **n√∫cleo** de Swagger.

## Objetivos principales
- Documentar APIs de forma **estandarizada**
- Validar contratos API (contract-first / design-first)
- Probar endpoints sin cliente personalizado
- Generar clientes, SDKs y servidores autom√°ticamente
- Reducir errores de integraci√≥n

## Componentes del ecosistema Swagger
- **Swagger Editor**
- **Swagger UI**
- **Swagger Hub**
- **Swagger AI**
- **Swagger Codegen / OpenAPI Generator**

## Swagger Editor
- Editor visual para crear y validar archivos OpenAPI
- Soporta YAML y JSON
- Validaci√≥n en tiempo real de la especificaci√≥n
- Puede usarse:
	- En navegador
	- Localmente
- Enlace:
	- [API Editor - Download or Try it in the Cloud](https://swagger.io/tools/swagger-editor/)

## Swagger UI
- Interfaz gr√°fica para **visualizar y probar APIs**
- Genera documentaci√≥n interactiva desde OpenAPI
- Permite ejecutar llamadas reales (`Try it out`)
- Muy usada en entornos de desarrollo y QA
- Frecuentemente integrada en frameworks backend

## Swagger Hub
- Plataforma colaborativa para equipos
- Funcionalidades:
	- Versionado de APIs
	- Revisi√≥n y comentarios
	- Gesti√≥n de m√∫ltiples APIs
	- Integraci√≥n con CI/CD
- Enfoque enterprise y equipos grandes

## Swagger AI
- Uso de IA para:
	- Generar documentaci√≥n desde definiciones parciales
	- Detectar inconsistencias
	- Sugerir mejoras en contratos
- Orientado a acelerar dise√±o y mantenimiento de APIs

## Documentaci√≥n de [api](/backend/api/)
- Swagger permite documentar:
	- Endpoints
	- M√©todos HTTP
	- Par√°metros
	- Respuestas
	- Errores
	- Autenticaci√≥n
- La documentaci√≥n es:
	- Viva (ligada al contrato)
	- Ejecutable (probable desde UI)
	- Compartible

## Par√°metros en Swagger
- Swagger define expl√≠citamente **d√≥nde** viaja cada par√°metro

### Query parameters
- Se env√≠an en la URL
- Usados para:
	- Filtros
	- Paginaci√≥n
	- B√∫squedas
- Ejemplo:
	- `/users?active=true&page=2`

### Path parameters
- Parte obligatoria de la ruta
- Identifican recursos
- Ejemplo:
	- `/users/{id}`

### Header parameters
- Se env√≠an en cabeceras HTTP
- Usados para:
	- Autenticaci√≥n
	- Versionado
	- Metadata
- Ejemplo:
	- `Authorization: Bearer token`

### Cookie parameters
- Definidos expl√≠citamente en OpenAPI
- Usados para:
	- Sesiones
	- Preferencias
- Menos comunes en APIs modernas REST

## Autenticaci√≥n y seguridad
- Swagger soporta m√∫ltiples esquemas:
	- API Key
	- HTTP Basic
	- Bearer Token (JWT)
	- OAuth 2.0
	- OpenID Connect
- La seguridad se define:
	- Globalmente
	- Por endpoint

## Casos de uso comunes
- Dise√±o contract-first de APIs
- Documentaci√≥n p√∫blica para desarrolladores
- Testing manual de endpoints
- Onboarding r√°pido de nuevos equipos
- Validaci√≥n de breaking changes
- Generaci√≥n autom√°tica de clientes

## Integraci√≥n con frameworks backend
- Java: Spring Boot (`springdoc-openapi`, `swagger-core`)
- Node.js: Express, NestJS
- Python: FastAPI, Flask
- .NET: ASP.NET Core
- Muchas integraciones generan OpenAPI autom√°ticamente desde anotaciones

## Generaci√≥n de c√≥digo
- A partir de OpenAPI se puede generar:
	- Clientes (JS, Java, Python, etc.)
	- Servidores base
	- SDKs
- Reduce c√≥digo repetitivo
- Asegura consistencia con el contrato

## Buenas pr√°cticas
- Usar **design-first** cuando sea posible
- Versionar la API expl√≠citamente
- Documentar errores y c√≥digos HTTP
- Mantener ejemplos reales
- No mezclar l√≥gica de negocio con documentaci√≥n manual
- Validar el contrato en CI/CD

## Recursos oficiales
- Art√≠culo introductorio:
	- [API Documentation Made Easy with OpenAPI & Swagger](https://swagger.io/resources/articles/documenting-apis-with-swagger/)
- Herramientas Swagger:
	- https://swagger.io/tools/

# Swagger ‚Äì Conceptos avanzados y temas complementarios

## Enfoques de dise√±o de APIs
- **Design-first**
	- La especificaci√≥n OpenAPI se escribe antes del c√≥digo
	- La API se implementa siguiendo el contrato
	- Ideal para equipos grandes y APIs p√∫blicas
- **Code-first**
	- El c√≥digo genera autom√°ticamente la especificaci√≥n
	- M√°s r√°pido para prototipos
	- Riesgo de documentaci√≥n incompleta o acoplada al framework
- **Contract-driven**
	- El contrato OpenAPI es la fuente de verdad
	- Se valida en CI/CD
	- Backend y frontend dependen del mismo contrato

## Versionado de APIs en Swagger
- Estrategias comunes:
	- Versionado en URL (`/v1/users`)
	- Versionado en header (`Accept: application/vnd.api.v1+json`)
- Swagger permite:
	- Mantener m√∫ltiples versiones del mismo contrato
	- Comparar cambios entre versiones
- Importante documentar:
	- Cambios breaking
	- Deprecaciones

## Reutilizaci√≥n con components
- OpenAPI permite definir elementos reutilizables
- Tipos comunes:
	- `schemas`
	- `parameters`
	- `responses`
	- `requestBodies`
	- `headers`
- Ventajas:
	- Menos duplicaci√≥n
	- Mayor consistencia
	- Mantenimiento m√°s sencillo

## Modelado de datos avanzado
- Soporte para:
	- Tipos primitivos
	- Objetos anidados
	- Arrays
	- Enumeraciones
- Composici√≥n de esquemas:
	- `oneOf`
	- `anyOf`
	- `allOf`
- √ötil para:
	- Polimorfismo
	- Herencia de modelos
	- Respuestas variables seg√∫n contexto

## Manejo de errores
- Documentaci√≥n expl√≠cita de:
	- C√≥digos HTTP (`400`, `401`, `403`, `404`, `500`)
	- Estructura de errores
- Buenas pr√°cticas:
	- Definir un esquema de error com√∫n
	- Incluir mensajes claros
	- A√±adir ejemplos de errores frecuentes

## Ejemplos y mock de APIs
- OpenAPI permite definir:
	- Ejemplos por campo
	- Ejemplos completos de request/response
- Casos de uso:
	- Mock servers
	- Frontend sin backend real
	- Pruebas tempranas de integraci√≥n
- Swagger Hub permite levantar mocks autom√°ticos

## Testing y validaci√≥n
- Validaci√≥n de:
	- Especificaci√≥n OpenAPI
	- Requests y responses contra el contrato
- Integraci√≥n con:
	- Tests autom√°ticos
	- Pipelines CI/CD
- Previene:
	- Cambios incompatibles
	- Respuestas fuera de contrato

## Automatizaci√≥n en CI/CD
- Usos habituales:
	- Validar OpenAPI en cada commit
	- Comparar contratos entre versiones
	- Bloquear despliegues con breaking changes
- Swagger/OpenAPI como artefacto versionado

## Documentaci√≥n p√∫blica vs privada
- Swagger permite:
	- Ocultar endpoints internos
	- Documentar solo lo expuesto al cliente
- Estrategias:
	- M√∫ltiples archivos OpenAPI
	- Filtrado por tags
- √ötil para:
	- APIs internas
	- APIs partner
	- APIs p√∫blicas

## Tags y organizaci√≥n
- Uso de `tags` para:
	- Agrupar endpoints
	- Mejorar navegaci√≥n en Swagger UI
- Buenas pr√°cticas:
	- Tags alineados con dominios de negocio
	- Evitar tags gen√©ricos (`default`, `misc`)

## Internacionalizaci√≥n de documentaci√≥n
- Descripciones en:
	- Ingl√©s
	- Idiomas locales
- Estrategias:
	- M√∫ltiples contratos
	- Campos descriptivos claros y concisos
- Importante para APIs globales

## Limitaciones de Swagger
- No describe l√≥gica de negocio compleja
- No reemplaza:
	- Diagramas de arquitectura
	- Documentaci√≥n funcional
- Puede crecer demasiado si no se estructura bien

## Swagger en APIs no REST
- Uso limitado fuera de REST
- Posible adaptaci√≥n para:
	- APIs HTTP no RESTful
- Alternativas m√°s adecuadas:
	- AsyncAPI para eventos
	- GraphQL SDL para GraphQL

## Alternativas y est√°ndares relacionados
- **OpenAPI** (base de Swagger)
- **AsyncAPI**
	- Documentaci√≥n de sistemas event-driven
- **GraphQL**
	- Autodescriptivo, pero distinto paradigma
- **gRPC + Protobuf**
	- Contrato fuerte, binario
	- Swagger no es nativo aqu√≠

## Evoluci√≥n y futuro
- Mayor uso de:
	- Contract testing
	- Mocking autom√°tico
	- IA para generaci√≥n y mantenimiento
- Swagger/OpenAPI como:
	- Pilar del API lifecycle
	- Fuente √∫nica de verdad para integraciones

# Swagger ‚Äì Casos de uso con ejemplos de c√≥digo

## Caso de uso: Dise√±o contract-first de una [api](/backend/api/)
- Se define el contrato OpenAPI antes de escribir c√≥digo
- Backend y frontend trabajan en paralelo
- El contrato es la fuente de verdad

## Ejemplo: Definici√≥n OpenAPI m√≠nima
### openapi.yaml
{% raw %}
```yaml
openapi: 3.0.3
info:
	title: User API
	version: 1.0.0
paths:
	/users:
		get:
			summary: Obtener usuarios
			responses:
				"200":
					description: Lista de usuarios
```
{% endraw %}`

## Caso de uso: Documentaci√≥n interactiva con Swagger UI

* Exponer documentaci√≥n navegable
* Permitir pruebas manuales de endpoints
* Reducir dependencias de herramientas externas

## Ejemplo: Integrar Swagger UI en Spring Boot

### Dependencia Maven

{% raw %}
```xml
<dependency>
	<groupId>org.springdoc</groupId>
	<artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
	<version>2.5.0</version>
</dependency>
```
{% endraw %}

### Acceso a Swagger UI

{% raw %}
```text
http://localhost:8080/swagger-ui.html
```
{% endraw %}

## Caso de uso: Documentar par√°metros (query, path, header)

* Evitar ambig√ºedades en el consumo de la API
* Permitir validaci√≥n autom√°tica de inputs

## Ejemplo: Par√°metros en OpenAPI

### parameters.yaml

{% raw %}
```yaml
paths:
	/users/{id}:
		get:
			parameters:
				- name: id
					in: path
					required: true
					schema:
						type: integer
				- name: verbose
					in: query
					schema:
						type: boolean
				- name: Authorization
					in: header
					required: true
					schema:
						type: string
			responses:
				"200":
					description: Usuario encontrado
```
{% endraw %}

## Caso de uso: Documentar request y response bodies

* Definir claramente estructuras de entrada y salida
* Facilitar validaciones y generaci√≥n de clientes

## Ejemplo: Request y Response

### schemas.yaml

{% raw %}
```yaml
components:
	schemas:
		User:
			type: object
			properties:
				id:
					type: integer
				name:
					type: string
				email:
					type: string
```
{% endraw %}

### Uso del schema

{% raw %}
```yaml
paths:
	/users:
		post:
			requestBody:
				required: true
				content:
					application/json:
						schema:
							$ref: "#/components/schemas/User"
			responses:
				"201":
					description: Usuario creado
```
{% endraw %}

## Caso de uso: Autenticaci√≥n con Bearer Token (JWT)

* Definir seguridad una sola vez
* Aplicarla globalmente o por endpoint

## Ejemplo: Seguridad en OpenAPI

### security.yaml

{% raw %}
```yaml
components:
	securitySchemes:
		BearerAuth:
			type: http
			scheme: bearer
			bearerFormat: JWT

security:
	- BearerAuth: []
```
{% endraw %}

## Caso de uso: Manejo y documentaci√≥n de errores

* Respuestas de error consistentes
* Mejor experiencia para consumidores

## Ejemplo: Respuesta de error est√°ndar

### errors.yaml

{% raw %}
```yaml
components:
	schemas:
		ErrorResponse:
			type: object
			properties:
				code:
					type: string
				message:
					type: string
```
{% endraw %}

### Uso en responses

{% raw %}
```yaml
responses:
	"400":
		description: Petici√≥n inv√°lida
		content:
			application/json:
				schema:
					$ref: "#/components/schemas/ErrorResponse"
```
{% endraw %}

## Caso de uso: Generaci√≥n autom√°tica de clientes

* Reducir c√≥digo manual
* Asegurar compatibilidad con el contrato

## Ejemplo: Generar cliente JavaScript

### CLI

{% raw %}
```bash
openapi-generator-cli generate \
	-i openapi.yaml \
	-g javascript \
	-o client-js
```
{% endraw %}

## Caso de uso: Mock de APIs para frontend

* Desarrollar frontend sin backend real
* Probar flujos completos desde Swagger

## Ejemplo: Definir ejemplos para mock

### mock.yaml

{% raw %}
```yaml
paths:
	/users:
		get:
			responses:
				"200":
					description: Lista mockeada
					content:
						application/json:
							example:
								- id: 1
									name: Alice
								- id: 2
									name: Bob
```
{% endraw %}

## Caso de uso: Validaci√≥n en CI/CD

* Prevenir cambios incompatibles
* Garantizar estabilidad del contrato

## Ejemplo: Validaci√≥n de OpenAPI

### Script de validaci√≥n

{% raw %}
```bash
swagger-cli validate openapi.yaml
```
{% endraw %}

## Caso de uso: Organizaci√≥n por tags

* Mejor navegaci√≥n en Swagger UI
* APIs grandes m√°s legibles

## Ejemplo: Uso de tags

### tags.yaml

{% raw %}
```yaml
paths:
	/users:
		get:
			tags:
				- Users
			summary: Listar usuarios
```
{% endraw %}

## Caso de uso: Comparaci√≥n y control de breaking changes

* Detectar cambios incompatibles
* Controlar evoluci√≥n de la API

## Ejemplo: Comparar contratos

### Diff de OpenAPI

{% raw %}
```bash
openapi-diff old.yaml new.yaml
```
{% endraw %}

## Caso de uso: Documentaci√≥n p√∫blica para terceros

* Publicar contrato como referencia oficial
* Reducir soporte y consultas repetidas

## Ejemplo: Publicaci√≥n

* Archivo `openapi.yaml` como artefacto versionado
* Swagger UI desplegado en entorno p√∫blico


