---
date: 2024-11-23 17:05
title: jest
tags:
  - jest
  - testing
  - CICD
  - devops
keywords:
source:
status: ğŸŒŸ
Parent: "[[Area-Prog]]"
cssclasses:
  - hide-embedded-header1
  - wide
categories:
  - Testing
public_note: "true"
category: Testing
---
# Jest
`$= dv.current().file.tags.join(" ")`

- [javascript](/desarrollo%20web/javascript/)
- [react](/frontend/react/)
- [Testing](/testing/testing/)
- Unit test
- integration test
- snapshot de componente
- integracion con [CICD](/devops/cicd/)
- github actions
- [Jest](https://jestjs.io/docs/getting-started)
- jest-sonar-jest-sonar
- [GuÃ­as de aprendizaje y prÃ¡ctica avanzada con Jest](/testing/gu-as-de-aprendizaje-y-pr-ctica-avanzada-con-jest/) ğŸ”¥ 

## ğŸ§  Conceptos Clave

- **Jest** es un framework de testing de JavaScript desarrollado por Facebook, optimizado para aplicaciones basadas en React, aunque puede emplearse en cualquier proyecto [javascript](/desarrollo%20web/javascript/).
- Se enfoca en la **simplicidad y velocidad**, integrando herramientas como mocks, spies, snapshots y un runner integrado.
- Permite ejecutar tests unitarios, de integraciÃ³n y de componentes con un entorno similar al del navegador.
- Es compatible con TypeScript mediante `ts-jest` o configuraciones personalizadas de `babel-jest`.
- Soporta **parallel testing** y caching inteligente para reducir tiempos de ejecuciÃ³n.

## ğŸ§© Tipos de Tests

- **Unit test**: verifican funciones o componentes individuales. Ejemplo: validar la salida de una funciÃ³n pura.
- **integration test**: prueban la interacciÃ³n entre varios mÃ³dulos o componentes. Por ejemplo, un formulario que envÃ­a datos a una API simulada.
- **Snapshot de componente**: compara la representaciÃ³n renderizada actual del componente con una guardada anteriormente para detectar cambios no deseados en la UI.

{% raw %}
```javascript
// Ejemplo de snapshot test
import renderer from 'react-test-renderer'
import Button from '../Button'

test('El componente Button se renderiza correctamente', () => {
	const tree = renderer.create(<Button label="Enviar" />).toJSON()
	expect(tree).toMatchSnapshot()
})
```
{% endraw %}`

## âš™ï¸ ConfiguraciÃ³n BÃ¡sica

{% raw %}
```bash
npm install --save-dev jest
```
{% endraw %}

En el archivo `package.json`:

{% raw %}
```json
{
	"scripts": {
		"test": "jest"
	}
}
```
{% endraw %}

ConfiguraciÃ³n opcional (por ejemplo, si usas Babel):

{% raw %}
```bash
npm install --save-dev babel-jest @babel/preset-env
```
{% endraw %}

Archivo `.babelrc`:

{% raw %}
```json
{
	"presets": ["@babel/preset-env", "@babel/preset-react"]
}
```
{% endraw %}

## ğŸ§ª Ejemplo de Test Unitario

{% raw %}
```javascript
// utils/sumar.js
export const sumar = (a, b) => a + b
```
{% endraw %}

{% raw %}
```javascript
// tests/sumar.test.js
import { sumar } from '../utils/sumar'

test('suma correctamente dos nÃºmeros', () => {
	expect(sumar(2, 3)).toBe(5)
})
```
{% endraw %}

## ğŸ§° IntegraciÃ³n con React

* Usa el paquete `@testing-library/react` para probar componentes React de manera mÃ¡s realista.
* Simula interacciones con el DOM, eventos y cambios de estado.

{% raw %}
```javascript
import { render, screen, fireEvent } from '@testing-library/react'
import TodoForm from '../TodoForm'

test('crea una nueva tarea al enviar el formulario', () => {
	render(<TodoForm />)
	fireEvent.change(screen.getByPlaceholderText(/nueva tarea/i), { target: { value: 'Aprender Jest' } })
	fireEvent.click(screen.getByText(/aÃ±adir/i))
	expect(screen.getByText(/Aprender Jest/i)).toBeInTheDocument()
})
```
{% endraw %}

## ğŸ”„ IntegraciÃ³n con [CICD](/devops/cicd/) y github actions

* Jest puede integrarse fÃ¡cilmente en pipelines CI/CD para ejecutar tests automÃ¡ticamente antes de hacer deploy.

{% raw %}
```yaml
# .github/workflows/test.yml
name: Run Jest Tests
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      - name: Install dependencies
        run: npm install
      - name: Run tests
        run: npm test -- --ci --coverage
```
{% endraw %}

## ğŸ“Š IntegraciÃ³n jest-sonar 
- jest-sonar-jest-sonar
* Permite generar reportes compatibles con SonarQube y SonarCloud, facilitando el anÃ¡lisis de calidad del cÃ³digo.
* InstalaciÃ³n:

{% raw %}
```bash
npm install --save-dev jest-sonar
```
{% endraw %}

* ConfiguraciÃ³n en `package.json`:

{% raw %}
```json
"jestSonar": {
  "reportPath": "coverage",
  "reportFile": "sonar-report.xml"
}
```
{% endraw %}

* EjecuciÃ³n:

{% raw %}
```bash
jest --coverage --testResultsProcessor jest-sonar
```
{% endraw %}

## ğŸ§  Consejos y Buenas PrÃ¡cticas

* Usa **mocks** y **spies** para aislar comportamientos externos (como peticiones HTTP).
* Organiza los tests en carpetas paralelas al cÃ³digo fuente (`/src` â†’ `/tests`).
* Aprovecha los **coverage reports** para medir quÃ© partes del cÃ³digo no estÃ¡n testeadas.
* MantÃ©n tus tests **rÃ¡pidos, independientes y deterministas**.
* Integra Jest con linters y herramientas de calidad de cÃ³digo para CI.

## ğŸ” Recursos Recomendados

* [Getting Started Â· Jest](https://jestjs.io/docs/getting-started)
* [Testing Library Docs](https://testing-library.com/docs/react-testing-library/intro/)
* [IntegraciÃ³n Jest + React + TypeScript](https://kulshekhar.github.io/ts-jest/)
* [GuÃ­a CI con GitHub Actions](https://docs.github.com/es/actions/guides/building-and-testing-nodejs)

