creation date: 2025-04-14 18:18
tags:
  - Hacking
  - hardening
keywords:
source:
status: üåü
Parent: "Area-Sistemas"
cssclasses:
  - hide-embedded-header1
  - wide
categories: "[ciberseguridad](/ciberseguridad/ciberseguridad/)"
aliases:
  - Prevenci√≥n de P√©rdida de Datos
  - DLP Prevenci√≥n de P√©rdida de Datos
public_note: "true"
# DLP  
``
- [hardening](/ciberseguridad/hardening/)  
- [control de datos](/ciberseguridad/control-de-datos/)
- [Email DLP Protecci√≥n Correo](/ciberseguridad/email-dlp-protecci-n-correo/)
- [DLP - ¬øQu√© es la prevenci√≥n de p√©rdida de datos? | Proofpoint ES](https://www.proofpoint.com/es/threat-reference/dlp)  
- [¬øQu√© es la prevenci√≥n de p√©rdida de datos (DLP)? | Seguridad de Microsoft](https://www.microsoft.com/es-es/security/business/security-101/what-is-data-loss-prevention-dlp)


# 1. Conceptos Fundamentales de DLP
La **Prevenci√≥n de P√©rdida de Datos (DLP)** es un conjunto de t√©cnicas, controles y procesos destinados a **detectar, prevenir y monitorizar** la exfiltraci√≥n o uso indebido de informaci√≥n sensible en una organizaci√≥n.

Incluye protecci√≥n frente a:
- Filtraci√≥n accidental o intencionada.  
- Uso indebido por empleados (negligente o malicioso).  
- Accesos no autorizados internos o externos.  
- Movimientos de datos no controlados entre aplicaciones, dispositivos o redes.

## Tipos de DLP
- **Endpoint DLP**: protege datos en dispositivos (copias, impresiones, USB, capturas de pantalla‚Ä¶).  
- **Network DLP**: inspecci√≥n de tr√°fico (SMTP, HTTPS, FTP, APIs).  
- **Storage / Cloud DLP**: supervisa repositorios, SaaS, buckets, bases de datos.  
- **Application DLP**: integra pol√≠ticas dentro de apps espec√≠ficas (O365, GSuite, CRM, ERP‚Ä¶).  
- **Behavioral DLP**: combina DLP con an√°lisis de comportamiento (UEBA).


# 2. Clasificaci√≥n de Datos y Modelos
La eficacia del DLP depende de identificar y etiquetar la informaci√≥n cr√≠tica:

## Reglas de Identificaci√≥n
- Datos sensibles: PII, PCI, PHI, secretos comerciales.  
- Datos regulados: GDPR, HIPAA, SOX, ENS.  
- Datos internos: propiedad intelectual, proyectos, c√≥digo fuente.  
- Datos operativos: configuraci√≥n, logs cr√≠ticos, infraestructura.

## T√©cnicas de Clasificaci√≥n
- **Basada en contenido:** patrones, expresiones regulares, diccionarios.  
- **Basada en contexto:** origen, aplicaci√≥n, usuario, dispositivo.  
- **Clasificaci√≥n autom√°tica:** ML, NLP y modelos adaptables.  
- **Clasificaci√≥n manual:** etiquetado por usuario.  


# 3. Patrones y Reglas de Detecci√≥n
El coraz√≥n de un sistema DLP bien dise√±ado.

## Patrones Comunes
- **RegEx avanzados** (PII, tarjetas, IBAN, NIF).  
- **Fingerprinting**: huellas de documentos completos.  
- **Exact Data Matching (EDM)**: coincidencias con bases de datos internas.  
- **Partial Document Matching (PDM)**.  
- **Clasificadores ML** para contenido no estructurado.

## Controles por Contexto
- Aplicaci√≥n usada  
- Usuario y rol  
- Dispositivo (corporativo / personal)  
- Red (VPN, corporativa, p√∫blica)  
- Acci√≥n: copiar, pegar, subir, imprimir, compartir, adjuntar


# 4. Alertas, Notificaciones y Playbooks
## Tipos de Alertas
- Alertas de severidad (baja, media, cr√≠tica).  
- Alertas por volumen anormal de datos salientes.  
- Alertas por patrones detectados.  
- Alertas por comportamiento at√≠pico del usuario.  
- Bloqueos preventivos o cautelares.

## Playbooks Autom√°ticos
- Bloqueo de transferencia.  
- Cifrado autom√°tico.  
- Solicitud de justificaci√≥n.  
- Escalado a seguridad o compliance.  
- Activaci√≥n de an√°lisis UEBA.


# 5. DLP y Redes / Infraestructura
## Protecciones en Red
- Monitoreo de tr√°fico saliente con inspecci√≥n profunda.  
- Proxy + CASB para inspecci√≥n de HTTPS.  
- Control de tr√°fico hacia dominios no autorizados.  
- Integraci√≥n con firewalls de nueva generaci√≥n.  

## En Infraestructura
- Control en servidores, repositorios, GitOps.  
- Detecci√≥n de exfiltraci√≥n a trav√©s de logs o endpoints.  
- DLP aplicado a **backups**, snapshots y entornos de desarrollo.


# 6. Monitoring del Usuario (UEBA + DLP)
La convergencia DLP + UEBA potencia la precisi√≥n y reduce falsos positivos.

## Comportamientos Monitorizables
- Acceso inusual a grandes vol√∫menes.  
- Picos de actividad fuera de horario.  
- Movimientos extra√±os entre repositorios.  
- Patrones de compresi√≥n o cifrado no autorizados.  
- Conexiones remotas inesperadas.

## Acciones Autom√°ticas
- Aumento din√°mico de restricciones.  
- Sesi√≥n bajo observaci√≥n.  
- Limitaci√≥n de permisos temporal.


# 7. Integraci√≥n del DLP en el [hardening](/ciberseguridad/hardening/)
## Estrategias de Hardening Relevantes
- Minimizaci√≥n de permisos (RBAC).  
- Cifrado en tr√°nsito y reposo.  
- Segmentaci√≥n de redes.  
- Pol√≠ticas Zero Trust.  
- Control de endpoints (EDR + DLP).  
- Reglas de firewall y DNS controlado.  
- Protecci√≥n del canal USB y dispositivos externos.  
- Monitoreo y auditor√≠as continuas.

## Ciclo de Hardening con DLP
- Descubrimiento ‚Üí Clasificaci√≥n ‚Üí Protecci√≥n ‚Üí Monitorizaci√≥n ‚Üí Respuesta ‚Üí Mejora.


# 8. Arquitectura de un Sistema DLP Moderno
## Componentes Clave
- **Motor de Clasificaci√≥n**  
- **Analizador de Contenido**  
- **Agentes Endpoint**  
- **Sensores de Red**  
- **Integraci√≥n con CASB / EDR / SIEM**  
- **Gesti√≥n de Pol√≠ticas**  
- **Motor de Alertas y Respuesta**  
- **Dashboard unificado**  

## Flujo General
1. Se observa la acci√≥n del usuario o movimiento de datos.  
2. El motor compara con patrones, reglas y contexto.  
3. Se eval√∫an pol√≠ticas activas.  
4. Se decide permitir, alertar, bloquear o cifrar.  
5. Se registra la actividad en el SIEM.  
6. Se genera un playbook si es necesario.


# 9. Implementaci√≥n Pr√°ctica (Gu√≠a Base)
## Checklist Inicial
- Inventario de datos.  
- Clasificaci√≥n por criticidad.  
- Selecci√≥n de flujos prioritarios.  
- Integraci√≥n con aplicaciones clave (correo, SaaS, endpoints).  
- Definir roles y responsables.  

## Controles Recomendados
- Pol√≠ticas espec√≠ficas por departamento.  
- Alertas de volumen y anomal√≠as.  
- Restricciones graduales por riesgo.  
- Revisi√≥n mensual de pol√≠ticas.  
- Test de exfiltraci√≥n controlada.


# 10. DLP en Correo Electr√≥nico ([Email DLP Protecci√≥n Correo](/ciberseguridad/email-dlp-protecci-n-correo/))
## Riesgos Clave
- Adjuntos indebidos  
- Auto-forwarding a dominios externos  
- Copias a cuentas personales  
- Fugas por enlaces compartidos  
- Exfiltraci√≥n a trav√©s de archivos comprimidos

## Controles y Pol√≠ticas Recomendadas
- Bloqueo o revisi√≥n de adjuntos con datos sensibles.  
- Justificaci√≥n obligatoria para dominios externos.  
- Inspecci√≥n de contenido autom√°tico antes del env√≠o.  
- Clasificaci√≥n del correo seg√∫n sensibilidad.  
- Reglas anti-phishing + spoofing.


# 11. Herramientas, Frameworks y Est√°ndares
## Herramientas DLP Populares
- **Microsoft Purview DLP**  
- **Symantec / Broadcom DLP**  
- **Proofpoint Enterprise DLP**  
- **Forcepoint DLP**  
- **McAfee / Trellix DLP**  
- **Zscaler + CASB integrado**  

## Frameworks y Est√°ndares
- **NIST 800-53** (familia AC y MP).  
- **NIST 800-171** para protecci√≥n de CUI.  
- **ISO/IEC 27001 & 27002** (A.8, A.12).  
- **GDPR / ENS / PCI-DSS** seg√∫n sector.  
- **MITRE ATT&CK (Tactic Exfiltration)** para mapear amenazas.  

## Mapas de Equivalencia entre Controles
- Acceso m√≠nimo ‚Üí ISO A.9 / NIST AC-6 / PCI 7  
- Monitoreo ‚Üí ISO A.12 / NIST AU-6 / ENS OPS  
- Protecci√≥n de datos ‚Üí ISO A.8 / NIST MP-5 / GDPR Art. 32  
- Segmentaci√≥n ‚Üí NIST SC-7 / ISO A.13  


# 12. Modelo de Pol√≠ticas DLP (Estructura)
## Niveles
- **Bajo riesgo:** advertencias suaves  
- **Medio riesgo:** solicitud de justificaci√≥n  
- **Alto riesgo:** bloqueo  
- **Cr√≠tico:** alerta + escalado autom√°tico

## Pol√≠tica Base (Plantilla)
- Tipo de dato protegido  
- Patr√≥n de detecci√≥n  
- Acci√≥n permitida  
- Acci√≥n bloqueada  
- Umbrales y condiciones  
- Escalado y auditor√≠a  
- Responsables de revisi√≥n  


# 13. Ejemplos de Pol√≠ticas en Pseudoc√≥digo

## Bloque de C√≥digo ‚Äî RegEx para PCI (Ejemplo)
### Identificaci√≥n de Tarjetas de Cr√©dito
{% raw %}
```regex
\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13})\b
```
{% endraw %}`

## Bloque de C√≥digo ‚Äî Pol√≠tica Simplificada

### Pol√≠tica de Env√≠o Externo con Datos Sensibles

{% raw %}
```json
{
	"policy": "Enviar a dominio externo",
	"conditions": [
		{"pattern": "PII", "threshold": 1},
		{"action": "email_send"}
	],
	"response": "block_and_notify"
}
```
{% endraw %}


# 14. Buenas Pr√°cticas Operativas

- Revisar reglas cada trimestre.  
- Evitar reglas demasiado amplias.  
- Documentar excepciones.  
- Incluir m√©tricas de efectividad.  
- Integrar SIEM + SOAR para automatizar respuestas.  
- Mantener formaciones recurrentes a usuarios.  


# 15. Expansi√≥n: Tendencias Modernas en DLP

- **DLP basado en IA**, capaz de identificar contenido no estructurado.  
- Uso de **Large Language Models** para evaluar contexto.  
- **DLP en DevOps** para evitar fugas en pipelines y repositorios.  
- **Tokenizaci√≥n** como alternativa al cifrado para minimizar impacto.  
- **DLP descentralizado** aplicado a dispositivos IoT e ICS.  

