creation date: 2025-04-14 18:50
tags:
  - autentication
  - Hacking
keywords:
source:
status: üåü
Parent: "Area-Sistemas"
cssclasses:
  - hide-embedded-header1
categories: "[autenticacion](/autenticacion/autenticacion/)"
public_note: "true"
# SAML

## Conceptos Fundamentales
- [autenticacion](/autenticacion/autenticacion/)
- [Protocolos](/redes/protocolos/)
- [XML](/databases/xml/)
- **SAML (Security Assertion Markup Language)** es un est√°ndar basado en **XML** utilizado para implementar [SSO Single Sign-On](/autenticacion/sso-single-sign-on/) en entornos corporativos y aplicaciones web.
- Permite que un **Identity Provider (IdP)** autentique al usuario y que un **Service Provider (SP)** conf√≠e en esa autenticaci√≥n sin gestionar credenciales directamente.

## Caracter√≠sticas Clave
- Est√°ndar maduro ampliamente soportado.
- Ideal para federaci√≥n entre organizaciones.
- Utiliza **Aserciones** firmadas digitalmente para garantizar integridad y autenticidad.
- Funciona principalmente mediante **redirecciones HTTP** y mensajes XML firmados.
- Independiente de plataforma y de lenguajes.

## Componentes de SAML
### Aserciones
- Incluyen informaci√≥n sobre:
	- Identidad del usuario.
	- Atributos (correo, roles, grupos‚Ä¶).
	- Condiciones de validez (audiencia, timestamps).
- Son firmadas por el IdP para garantizar integridad.

### IdP (Identity Provider)
- Responsable de autenticar al usuario (contrase√±a, MFA, etc.).
- Emite aserciones SAML.
- Ejemplos: ADFS, Okta, Shibboleth, Keycloak.

### SP (Service Provider)
- Consume la aserci√≥n emitida por el IdP.
- Valida firma, audiencia, expiraci√≥n.
- Utiliza los atributos para crear sesi√≥n local.

## Tipos de Perfiles SAML
### Web Browser [SSO](/autenticacion/sso-single-sign-on/) Profile
- El m√°s utilizado.
- Usa POST/Redirect para intercambio de mensajes.
- Ideal para aplicaciones web tradicionales.

### Artifact Resolution Profile
- En lugar de enviar la aserci√≥n completa, se env√≠a un "artefacto" para ser resuelto por back-channel.
- M√°s seguro en escenarios sensibles.

### Single Logout (SLO)
- Permite cerrar sesi√≥n en todos los SP federados.
- Funciona mediante mensajes de logout firmados.

## Flujo General de SAML 2.0
1. El usuario accede a un SP.
2. El SP redirige al IdP con una **AuthnRequest**.
3. El IdP autentica al usuario.
4. IdP devuelve una **Aserci√≥n SAML** firmada al SP.
5. El SP valida la firma y crea la sesi√≥n del usuario.

## Ventajas
- Alta interoperabilidad entre proveedores.
- Modelo muy seguro cuando se configuran correctamente firmas y certificados.
- √ötil para aplicaciones heredadas que no soportan OIDC.

## Desventajas
- Basado en XML: mensajes m√°s pesados que OIDC.
- Complejidad en configuraci√≥n.
- Menos orientado a dispositivos m√≥viles o SPAs.
- Menor soporte moderno respecto a OIDC.

## Diferencias con Otros Protocolos
- **[LDAP](/autenticacion/ldap/) vs SAML**:
	- LDAP es un **directorio** y m√©todo de autenticaci√≥n tradicional.
	- SAML es un **protocolo de federaci√≥n**.
	- Ver: [La diferencia entre LDAP y SAML SSO - JumpCloud](https://jumpcloud.com/es/blog/difference-ldap-saml-sso)

- **SAML vs OIDC**:
	- SAML ‚Üí XML, dise√±ado para SSO corporativo cl√°sico.
	- OIDC ‚Üí JSON/JWT, ideal para aplicaciones modernas y APIs.

## Enlaces de Referencia
- [SAML diferencias](https://www.entrust.com/es/resources/learn/what-is-saml)
- [¬øQu√© es SAML 2.0 y c√≥mo funciona? - Auth0](https://auth0.com/es/intro-to-iam/what-is-saml)
- [Security Assertion Markup Language - Wikipedia](https://es.wikipedia.org/wiki/Security_Assertion_Markup_Language)

## Ejemplo de Aserci√≥n SAML (simplificada)
### C√≥digo
{% raw %}
```xml
<saml:Assertion ID="_12345" IssueInstant="2025-11-14T12:00:00Z" Version="2.0">
	<saml:Issuer>https://idp.example.com</saml:Issuer>
	<saml:Subject>
		<saml:NameID Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress">
			user@example.com
		</saml:NameID>
	</saml:Subject>
	<saml:AttributeStatement>
		<saml:Attribute Name="role">
			<saml:AttributeValue>admin</saml:AttributeValue>
		</saml:Attribute>
	</saml:AttributeStatement>
</saml:Assertion>
```
{% endraw %}`

