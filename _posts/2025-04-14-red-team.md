---
date: 2025-04-14 20:51
title: Red team
keywords:
source:
status: üåü
Parent: "[[Area-Sistemas]]"
public_note: "true"
category: Hacking
tags:
  - Hacking
  - pentesting
  - ciberseguridad
---
# Red team
`$= dv.current().file.tags.join(" ")`

## Concepto y objetivos
- El **Red Team** es una disciplina de ciberseguridad ofensiva centrada en **simular adversarios reales** (APT, cibercrimen organizado, insiders) para evaluar la **detecci√≥n, respuesta y resiliencia** de una organizaci√≥n.
- A diferencia del pentesting tradicional, el enfoque es:
	- Basado en **objetivos de negocio**
	- Con **t√©cnicas encadenadas** (kill chain completa)
	- Orientado a **evasi√≥n**, **persistencia** y **sigilo**
- El resultado no es solo encontrar vulnerabilidades, sino **medir la capacidad defensiva real** (personas, procesos y tecnolog√≠a).

## Relaci√≥n con otras disciplinas
- [Pentesting](/ciberseguridad/pentesting/)
	- Evaluaci√≥n t√©cnica puntual de sistemas y aplicaciones
	- El Red Team puede reutilizar t√©cnicas, pero con mayor contexto y alcance
- [Software engineering](/uncategorized/software-engineering/)
	- Desarrollo de tooling propio, automatizaci√≥n y malware controlado
	- Necesario para evadir defensas modernas
	- [Backend](/uncategorized/backend/)
	- [python](/software%20engineering/python/)
	- [vuejs](/frontend/vuejs/)
	- Go

## Certificaciones relacionadas
- [CARTP](/ciberseguridad/cartp/)
	- Certificaci√≥n centrada en **Red Teaming pr√°ctico**
	- Uso de Active Directory, evasi√≥n y post-explotaci√≥n
- [OSCP](/ciberseguridad/oscp/)
	- Base t√©cnica s√≥lida en explotaci√≥n y enumeraci√≥n
	- No espec√≠fica de Red Team, pero muy relevante
- [CRTO](/ciberseguridad/crto/)
	- Enfoque en **Adversary Simulation** y TTPs reales
	- Uso intensivo de frameworks como C2 y MITRE ATT&CK

## Metodolog√≠a y marcos de referencia
- Uso de **[MITRE ATT&CK](/ciberseguridad/mitre-att-ck/)** como lenguaje com√∫n para mapear t√©cnicas
- Emulaci√≥n de amenazas basada en:
	- TTPs reales
	- Inteligencia de amenazas
	- Escenarios espec√≠ficos del sector
- Fases habituales:
	- Reconocimiento externo e interno
	- Acceso inicial
	- Persistencia
	- Movimiento lateral
	- Exfiltraci√≥n / impacto
	- Evasi√≥n y antiforensics

## Infraestructura objetivo
- [Windows Server](/devops/windows-server/) ad
	- [Active Directory](/sistemas/active-directory/) como n√∫cleo del entorno corporativo
	- Abuso de:
		- [Kerberos](/autenticacion/kerberos/)
		- NTLM
		- GPO
		- Delegaciones
		- Servicios mal configurados
- Integraci√≥n con servicios cloud e h√≠bridos (Azure AD, O365)

## Malware y desarrollo ofensivo
- [malware](/ciberseguridad/malware/)
	- Desarrollo de payloads personalizados
	- Modificaci√≥n de loaders y stagers
	- Uso de cifrado, ofuscaci√≥n y t√©cnicas fileless
- Enfoque en:
	- Bypass de EDR/AV
	- Living Off The Land (LOLBins)
	- Persistencia encubierta

## Herramientas de simulaci√≥n APT
- herramientas de simulaci√≥n APT
	- [APT Simulator: simula que un equipo ha sido v√≠ctima de una APT](https://www.hackplayers.com/2018/02/apt-simulator-simula-una-apt.html)
		- Permite validar detecciones defensivas
		- √ötil para ejercicios Purple Team
		- Simulaci√≥n de fases completas de ataque

## Ingenier√≠a inversa
- Ingenier√≠a inversa
	- An√°lisis de malware real
	- Comprensi√≥n de t√©cnicas usadas por actores avanzados
	- Identificaci√≥n de patrones reutilizables
- Uso en Red Team para:
	- Crear malware m√°s realista
	- Mejorar t√©cnicas de evasi√≥n
	- Entender detecciones defensivas

## Kernel y bajo nivel
- kernels
	- [Operating System Internals: A brief introduction to Kernels | by Z3R0 | Medium](https://medium.com/@amatajosh/an-introduction-to-kernels-1909a46228d9)
		- Fundamentos de kernels y modo usuario/kernel
		- Base para:
			- Rootkits
			- Drivers maliciosos
			- Evasi√≥n avanzada de EDR

## Documentaci√≥n y referencias
- docs
	- [¬øQu√© es el Red Team en Ciberseguridad y C√≥mo Funciona?](https://www.deltaprotect.com/blog/que-es-red-team-ciberseguridad)
		- Introducci√≥n conceptual al Red Team
	- [Definitions | Red Team Development and Operations](https://redteam.guide/docs/definitions/)
		- Glosario y conceptos clave
	- [DESARROLLADOR RED TEAM Detalles del puesto | Telef√≥nica](https://jobs.telefonica.com/job/MADRID-DESARROLLADOR-RED-TEAM/1074442001/)
		- Expectativas reales del rol profesional
# Red team ‚Äî Extensi√≥n y conceptos avanzados

## Threat Intelligence aplicada
- Uso de **inteligencia de amenazas** para dise√±ar escenarios realistas
- Fuentes habituales:
	- Informes p√∫blicos de APT
	- IOC, TTPs y playbooks defensivos
	- Inteligencia sectorial y geopol√≠tica
- Conversi√≥n de inteligencia en:
	- Escenarios de ataque
	- Objetivos t√©cnicos y de negocio
	- Supuestos realistas del adversario

## Dise√±o de escenarios y campa√±as
- Creaci√≥n de **campa√±as completas** en lugar de pruebas aisladas
- Definici√≥n de:
	- Objetivo final (crown jewels)
	- Restricciones (reglas de enfrentamiento)
	- Nivel de ruido permitido
- Tipos de escenarios:
	- Compromiso de identidad
	- Acceso inicial v√≠a usuario
	- Ataque interno simulando insider
	- Compromiso de cadena de suministro

## Infraestructura de Comando y Control (C2)
- Dise√±o de **infraestructura ofensiva resiliente**
- Elementos clave:
	- Redirectores
	- Domain fronting
	- Rotaci√≥n de IPs y dominios
- Protocolos y canales:
	- HTTP/HTTPS
	- DNS
	- SMB / Named Pipes
	- Canales encubiertos
- Importancia del **perfilado de tr√°fico** para evasi√≥n

## OPSEC y evasi√≥n
- OPSEC
	- Minimizar huellas t√©cnicas y humanas
	- Control de tiempos, patrones y errores operativos
- T√©cnicas habituales:
	- Evasi√≥n de EDR mediante comportamiento
	- Uso de herramientas nativas del sistema
	- Separaci√≥n de infraestructura
- Gesti√≥n de errores:
	- Kill-switches
	- Rollback de persistencia
	- Contenci√≥n controlada

## Ingenier√≠a social
- Uso de vectores humanos como punto de entrada
- T√©cnicas frecuentes:
	- Phishing dirigido
	- Spear phishing
	- Vishing y smishing
- Integraci√≥n con Red Team:
	- Payloads personalizados
	- Infraestructura dedicada
	- M√©tricas de concienciaci√≥n y detecci√≥n

## Red Team en entornos Cloud
- Ataques sobre:
	- Identidades cloud
	- APIs
	- Roles y permisos mal definidos
- T√©cnicas comunes:
	- Abuso de tokens
	- Escalada de privilegios en cloud
	- Movimiento lateral entre servicios
- Importancia del enfoque h√≠brido:
	- On-prem + cloud
	- Identidad como nuevo per√≠metro

## Purple Team
- [Purple Team](/ciberseguridad/purple-team/)
	- Colaboraci√≥n directa entre ofensiva y defensiva
	- Ajuste en tiempo real de detecciones
- Beneficios:
	- Mejora continua de reglas
	- Reducci√≥n de falsos positivos
	- Mayor transferencia de conocimiento
- Uso de ATT&CK como puente com√∫n

## M√©tricas y evaluaci√≥n
- M√©tricas t√©cnicas:
	- Tiempo hasta detecci√≥n
	- Tiempo hasta contenci√≥n
	- T√©cnicas no detectadas
- M√©tricas de negocio:
	- Impacto potencial
	- Superficie de ataque real
	- Riesgo residual
- Evaluaci√≥n comparativa:
	- Antes vs despu√©s
	- Evoluci√≥n de la madurez defensiva

## Reporting avanzado
- Informes orientados a distintos p√∫blicos:
	- T√©cnico
	- Ejecutivo
	- Direcci√≥n
- Componentes clave:
	- Narrativa del ataque
	- Decisiones del adversario
	- Brechas de proceso y tecnolog√≠a
- Enfoque en:
	- Riesgo
	- Prioridades
	- Mejora continua

## Aspectos legales y √©ticos
- Definici√≥n clara de:
	- Alcance
	- Autorizaciones
	- Datos sensibles
- Cumplimiento de:
	- Legislaci√≥n local
	- Normativas internas
	- Requisitos contractuales
- Importancia de la trazabilidad y control

## Madurez del Red Team
- Niveles de madurez:
	- Ejercicios ad-hoc
	- Campa√±as peri√≥dicas
	- Emulaci√≥n continua de adversarios
- Integraci√≥n con:
	- Gesti√≥n de riesgos
	- Threat Intelligence
	- SOC y Blue Team
- Objetivo final:
	- Mejora sostenida de la postura defensiva

# Red team ‚Äî Labs pr√°cticos
`$= dv.current().file.tags.join(" ")`

## Listado de labs por dominio

### Acceso inicial
- Phishing dirigido con payload evasivo
- Password spraying controlado sobre AD
- Abuso de aplicaciones web internas
- Compromiso de VPN con credenciales reutilizadas

### Active Directory
- Enumeraci√≥n sigilosa de AD
- Kerberoasting orientado a privilegios
- Abuso de delegaciones Kerberos
- Ataques a GPO mal configuradas
- Escalada v√≠a ACLs y permisos delegados

### Post-explotaci√≥n
- Dumping de credenciales sin LSASS directo
- Living Off The Land (LOLBins)
- Persistencia encubierta
- Movimiento lateral con cuentas de servicio

### Comando y Control
- C2 HTTP con redirectores
- C2 DNS de bajo ruido
- Named Pipes para entorno interno
- Evasi√≥n por perfilado de tr√°fico

### Malware y evasi√≥n
- Loader en memoria
- Ofuscaci√≥n b√°sica y polimorfismo
- Bypass de AMSI
- Evasi√≥n de EDR basada en comportamiento

### Ingenier√≠a social
- Spear phishing t√©cnico
- Phishing con documentos maliciosos
- Vishing con pretexting
- Ataques combinados humano + t√©cnico

### Cloud e h√≠brido
- Abuso de tokens cloud
- Escalada de privilegios en Azure AD
- Movimiento lateral entre cloud y on-prem
- Persistencia en identidades cloud

### Purple Team
- Ejercicio de emulaci√≥n ATT&CK
- Ajuste de reglas de detecci√≥n
- Validaci√≥n de alertas del SOC
- Medici√≥n de tiempo de detecci√≥n

## Lab desarrollado ‚Äî Compromiso de Active Directory con bajo ruido

### Objetivo del lab
- Obtener **control de dominio** partiendo de un usuario est√°ndar
- Mantener **bajo nivel de detecci√≥n**
- Documentar todas las decisiones como adversario

### Escenario
- Entorno Windows corporativo
- Un dominio con:
	- Usuarios est√°ndar
	- Cuentas de servicio
	- Servidores Windows
- Acceso inicial simulado mediante credenciales v√°lidas de bajo privilegio

### Reglas del ejercicio
- Prohibido usar exploits ruidosos
- No uso de herramientas autom√°ticas masivas
- Priorizar LOLBins y t√©cnicas nativas
- Toda acci√≥n debe mapearse a ATT&CK

### Fase 1 ‚Äî Enumeraci√≥n inicial
- Enumeraci√≥n de dominio sin escaneo activo
- Objetivos:
	- Identificar cuentas de servicio
	- Detectar relaciones de confianza
	- Localizar equipos de inter√©s
- T√©cnicas:
	- LDAP queries
	- Comandos nativos de Windows
	- Enumeraci√≥n basada en permisos

### C√≥digo ‚Äî Enumeraci√≥n b√°sica de dominio
#### Enumeraci√≥n de usuarios y grupos
{% raw %}
```powershell
whoami
net user /domain
net group "Domain Admins" /domain
```
{% endraw %}`

### Fase 2 ‚Äî Identificaci√≥n de vectores de escalada

* An√°lisis de:
  * SPNs configurados
  * Permisos delegados
  * Grupos con privilegios excesivos
* Decisi√≥n del adversario:
  * Priorizar Kerberoasting frente a exploits

### C√≥digo ‚Äî Kerberoasting selectivo

#### Extracci√≥n de tickets Kerberos

{% raw %}
```powershell
setspn -T DOMAIN.LOCAL -Q */*
```
{% endraw %}

### Fase 3 ‚Äî Explotaci√≥n controlada

* Solicitud de tickets Kerberos
* Crackeo offline de hashes
* Validaci√≥n de credenciales obtenidas
* Acceso a cuenta de servicio con mayores privilegios

### Fase 4 ‚Äî Movimiento lateral

* Uso de credenciales v√°lidas
* Acceso remoto sigiloso
* Enumeraci√≥n local del nuevo host
* B√∫squeda de nuevas oportunidades de escalada

### C√≥digo ‚Äî Movimiento lateral nativo

#### Acceso remoto con herramientas del sistema

{% raw %}
```powershell
wmic /node:HOSTNAME process call create "cmd.exe"
```
{% endraw %}

### Fase 5 ‚Äî Escalada a Domain Admin

* Abuso de:
  * ACLs mal configuradas
  * Delegaciones Kerberos
  * Membres√≠as heredadas
* Obtenci√≥n de control del dominio
* Validaci√≥n m√≠nima del acceso

### Fase 6 ‚Äî Persistencia

* Persistencia no obvia
* T√©cnicas posibles:
  * ACLs persistentes
  * Backdoor en cuentas de servicio
  * Abuso de GPO existente

### Fase 7 ‚Äî Objetivo final

* Acceso a:
  * DC
  * Crown jewels simulados
* Prueba de impacto:

  * Acceso a informaci√≥n cr√≠tica
  * Capacidad de control sostenido

### M√©tricas a evaluar

* Tiempo hasta detecci√≥n
* T√©cnicas detectadas vs no detectadas
* Nivel de ruido generado
* Decisiones del adversario

### Entregables del lab

* Diagrama del ataque
* Mapping ATT&CK
* Evidencias m√≠nimas
* Recomendaciones defensivas priorizadas

# Red team ‚Äî Recursos y herramientas (2025)

## Colecciones de recursos
- Repositorios ‚Äúawesome‚Äù con **listas curadas de herramientas y referencias**:
	- [Awesome Red Team Operations](https://github.com/CyberSecurityUP/Awesome-Red-Team-Operations)
	- [Awesome Red Teaming](https://github.com/yeyintminthuhtut/Awesome-Red-Teaming)
	- [Red Teaming Toolkit](https://0x1.gitlab.io/pentesting/Red-Teaming-Toolkit/)
	- Otras listas de inter√©s:
		- [Awesome OSINT](https://github.com/jivoi/awesome-osint)
		- [Awesome Pentest](https://github.com/enaqx/awesome-pentest)
		- [Awesome Cloud Pentest](https://github.com/dafthack/awesome-cloud-pentest)

## Frameworks de comando y control (C2)
*(fundamentales para operaciones de post-explotaci√≥n y simulaci√≥n de adversarios)*

- **Sliver** ‚Äì C2 open-source, multi‚Äëplataforma, tr√°fico cifrado y m√∫ltiples transportes  
	- [https://github.com/BishopFox/sliver](https://github.com/BishopFox/sliver)
- **PoshC2** ‚Äì Framework C2 en Python con fuerte enfoque en OPSEC  
	- [https://github.com/nettitude/PoshC2](https://github.com/nettitude/PoshC2)
- **Cobalt Strike** ‚Äì C2 comercial ampliamente usado en simulaciones avanzadas  
	- [https://www.cobaltstrike.com](https://www.cobaltstrike.com)
- **Mythic** ‚Äì C2 modular con arquitectura moderna y m√∫ltiples agentes  
	- [https://github.com/its-a-feature/Mythic](https://github.com/its-a-feature/Mythic)
- **Merlin** ‚Äì C2 ligero escrito en Go, soporte HTTP/2  
	- [https://github.com/Ne0nd0g/merlin](https://github.com/Ne0nd0g/merlin)
- **Empire** ‚Äì Framework de post‚Äëexplotaci√≥n PowerShell/Python  
	- [https://github.com/BC-SECURITY/Empire](https://github.com/BC-SECURITY/Empire)
- **Havoc** ‚Äì C2 open-source con enfoque en evasi√≥n y personalizaci√≥n  
	- [https://github.com/HavocFramework/Havoc](https://github.com/HavocFramework/Havoc)

## Reconocimiento y [OSINT](/ciberseguridad/osint/)
*(superficie de ataque, enumeraci√≥n pasiva y activa)*

- **Shodan** ‚Äì B√∫squeda de servicios y dispositivos expuestos  
	- [https://www.shodan.io](https://www.shodan.io)
- **Censys** ‚Äì Descubrimiento de infraestructura global  
	- [https://censys.io](https://censys.io)
- **BinaryEdge** ‚Äì Escaneo masivo de Internet  
	- [https://www.binaryedge.io](https://www.binaryedge.io)
- **FOFA** ‚Äì Motor de b√∫squeda de activos expuestos  
	- [https://fofa.info](https://fofa.info)
- **Amass** ‚Äì Mapeo de superficie de ataque  
	- [https://github.com/owasp-amass/amass](https://github.com/owasp-amass/amass)
- **Subfinder** ‚Äì Descubrimiento r√°pido de subdominios  
	- [https://github.com/projectdiscovery/subfinder](https://github.com/projectdiscovery/subfinder)
- **SpiderFoot** ‚Äì Automatizaci√≥n OSINT  
	- [https://github.com/smicallef/spiderfoot](https://github.com/smicallef/spiderfoot)
- **Recon-ng** ‚Äì Framework OSINT modular  
	- [https://github.com/lanmaster53/recon-ng](https://github.com/lanmaster53/recon-ng)
- **Maltego** ‚Äì An√°lisis visual de relaciones  
	- [https://www.maltego.com](https://www.maltego.com)
- **OSINT Framework** ‚Äì Directorio de recursos OSINT  
	- [https://osintframework.com](https://osintframework.com)

## Evaluaci√≥n de red y web
*(escaneo, fuzzing, inspecci√≥n)*

- **Nmap** ‚Äì Escaneo de red y servicios  
	- [https://nmap.org](https://nmap.org)
- **Masscan** ‚Äì Escaneo a gran escala  
	- [https://github.com/robertdavidgraham/masscan](https://github.com/robertdavidgraham/masscan)
- **Naabu** ‚Äì Esc√°ner de puertos r√°pido  
	- [https://github.com/projectdiscovery/naabu](https://github.com/projectdiscovery/naabu)
- **Burp Suite** ‚Äì Proxy y testing web  
	- [https://portswigger.net/burp](https://portswigger.net/burp)
- **OWASP ZAP** ‚Äì Proxy open-source  
	- [https://www.zaproxy.org](https://www.zaproxy.org)
- **Nuclei** ‚Äì Escaneo basado en templates  
	- [https://github.com/projectdiscovery/nuclei](https://github.com/projectdiscovery/nuclei)
- **Nikto** ‚Äì Esc√°ner web cl√°sico  
	- [https://github.com/sullo/nikto](https://github.com/sullo/nikto)
- **sqlmap** ‚Äì Automatizaci√≥n de SQLi  
	- [https://github.com/sqlmapproject/sqlmap](https://github.com/sqlmapproject/sqlmap)
- **ffuf** ‚Äì Fuzzing web r√°pido  
	- [https://github.com/ffuf/ffuf](https://github.com/ffuf/ffuf)
- **dirsearch** ‚Äì Enumeraci√≥n de rutas  
	- [https://github.com/maurosoria/dirsearch](https://github.com/maurosoria/dirsearch)
- **httpx** ‚Äì Validaci√≥n y probing HTTP  
	- [https://github.com/projectdiscovery/httpx](https://github.com/projectdiscovery/httpx)

## [ Active Directory](/sistemas/active-directory/) y explotaci√≥n de identidades
*(b√°sico para entornos corporativos)*

- **BloodHound / SharpHound** ‚Äì An√°lisis de caminos de ataque en AD  
	- [https://github.com/BloodHoundAD/BloodHound](https://github.com/BloodHoundAD/BloodHound)
- **BloodHound.py** ‚Äì Ingestor AD en Python  
	- [https://github.com/fox-it/BloodHound.py](https://github.com/fox-it/BloodHound.py)
- **GhostPack** ‚Äì Colecci√≥n de tooling ofensivo para AD  
	- [https://github.com/GhostPack](https://github.com/GhostPack)
- **Impacket** ‚Äì Manipulaci√≥n de protocolos Windows  
	- [https://github.com/fortra/impacket](https://github.com/fortra/impacket)

## Contrase√±a y credenciales
*(crackeo, fuerza bruta, an√°lisis de hashes)*

- **Hashcat** ‚Äì Cracking con GPU  
	- [https://hashcat.net/hashcat](https://hashcat.net/hashcat)
- **John the Ripper** ‚Äì Cracker multiprop√≥sito  
	- [https://www.openwall.com/john](https://www.openwall.com/john)
- **MSOLSpray** ‚Äì Password spraying contra Azure AD  
	- [https://github.com/dafthack/MSOLSpray](https://github.com/dafthack/MSOLSpray)

## Phishing y vectores de acceso inicial
- **GoPhish** ‚Äì Framework de phishing open-source  
	- [https://github.com/gophish/gophish](https://github.com/gophish/gophish)
- **Evilginx2** ‚Äì Phishing con captura de sesi√≥n  
	- [https://github.com/kgretzky/evilginx2](https://github.com/kgretzky/evilginx2)
- **CredSniper** ‚Äì Harvesting de credenciales  
	- [https://github.com/ustayready/CredSniper](https://github.com/ustayready/CredSniper)

## Evasi√≥n, carga √∫til y post‚Äëexplotaci√≥n
*(actividad interna post‚Äëcompromiso)*

- **Covenant** ‚Äì C2 en .NET  
	- [https://github.com/cobbr/Covenant](https://github.com/cobbr/Covenant)
- **Veil** ‚Äì Generaci√≥n de payloads evasivos  
	- [https://github.com/Veil-Framework/Veil](https://github.com/Veil-Framework/Veil)
- **Invoke-Obfuscation** ‚Äì Ofuscaci√≥n PowerShell  
	- [https://github.com/danielbohannon/Invoke-Obfuscation](https://github.com/danielbohannon/Invoke-Obfuscation)
- **Mimikatz** ‚Äì Extracci√≥n de credenciales  
	- [https://github.com/gentilkiwi/mimikatz](https://github.com/gentilkiwi/mimikatz)

## Plataformas integrales
*(automatizaci√≥n y simulaci√≥n continua)*

- **FireCompass** ‚Äì Continuous Automated Red Teaming  
	- [https://www.firecompass.com](https://www.firecompass.com)
- **Kali Linux** ‚Äì Distribuci√≥n ofensiva completa  
	- [https://www.kali.org](https://www.kali.org)

## OSINT avanzadas
*(identidad, redes sociales, b√∫squedas pasivas)*

- Scripts y colecciones OSINT avanzadas  
	- [https://github.com/topics/osint](https://github.com/topics/osint)

## Formaci√≥n y aprendizaje
- **RTOD‚Äë200: Red Team Ops Developer Advanced**  
	- [https://academy.spartan-cybersec.com](https://academy.spartan-cybersec.com)
- Cursos de herramientas y pentesting  
	- [https://www.openwebinars.net](https://www.openwebinars.net)

## Notas de contexto 2025
- Uso creciente de herramientas leg√≠timas reutilizadas por actores maliciosos  
	- [https://attack.mitre.org](https://attack.mitre.org)
