---
date: 2025-01-10 18:47
title: gitlab
keywords:
source:
status: üåü
Parent: "[[Area-Sistemas]]"
public_note: "true"
category: cloud
tags:
  - devops
  - gitlab
  - CICD
---
# gitlab

- [devops](/devops/devops/)
- [cloud](/cloud/cloud/)
- [GitLab](https://about.gitlab.com/install/)

## Conceptos clave
- Plataforma **DevOps all-in-one** que integra repositorios Git, CI/CD, gesti√≥n de issues, seguridad y despliegues.
- Alternativa **self-hosted** a servicios SaaS, con control total sobre datos y configuraci√≥n.
- Soporta flujos **GitOps**, **CI/CD declarativo** y automatizaci√≥n de infraestructura.
- Componentes principales:
	- **GitLab Rails App** (UI, API, permisos).
	- **Gitaly** (gesti√≥n de repositorios Git).
	- **CI/CD** (pipelines, runners).
	- **Registry** (contenedores, paquetes).
	- **Seguridad** (SAST, DAST, Dependency Scanning).

## Casos de uso
- Monorepos y multirepos con control de permisos.
- Pipelines CI/CD para backend, frontend y mobile.
- Registro privado de contenedores Docker.
- Gesti√≥n de proyectos y planificaci√≥n (issues, boards, milestones).
- Integraci√≥n con [Kubernetes](/virtualizacion/kubernetes/) y despliegues continuos.

## Instalaci√≥n en [Docker](/software%20engineering/docker/)
- Imagen oficial:
	- [gitlab/gitlab-ee](https://hub.docker.com/r/gitlab/gitlab-ee/)
- Documentaci√≥n:
	- [Configurar GitLab en Docker](https://docs.gitlab.com/ee/install/docker/configuration.html)
	- [Requisitos de instalaci√≥n](https://docs.gitlab.com/ee/install/requirements.html)

## Requisitos m√≠nimos
- CPU: 2 cores (recomendado 4+).
- RAM: 4 GB m√≠nimo (8 GB recomendado).
- Disco: depende del uso de repositorios y artefactos.
- Docker Engine actualizado.

## Estructura de vol√∫menes
- **/etc/gitlab** ‚Üí configuraci√≥n (`gitlab.rb`).
- **/var/log/gitlab** ‚Üí logs.
- **/var/opt/gitlab** ‚Üí datos (repos, uploads, registry).

## Configuraci√≥n b√°sica
- URL externa (`external_url`) para acceso web.
- Puertos HTTP/HTTPS y SSH.
- SMTP para notificaciones.
- Backups programados y retenci√≥n.

## Ejemplo de despliegue con Docker
### docker run
{% raw %}
```bash
docker run -d \
	--name gitlab \
	--restart always \
	--hostname gitlab.example.com \
	-p 80:80 \
	-p 443:443 \
	-p 22:22 \
	-v /srv/gitlab/config:/etc/gitlab \
	-v /srv/gitlab/logs:/var/log/gitlab \
	-v /srv/gitlab/data:/var/opt/gitlab \
	gitlab/gitlab-ee:latest
```
{% endraw %}`

## Networking y acceso

- Configurar DNS para `external_url`.
- Reverse proxy opcional (NGINX, Traefik).
- Certificados TLS con Let‚Äôs Encrypt o propios.
- Acceso SSH para Git sobre el puerto configurado.

## CI/CD y Runners

- GitLab Runner para ejecutar pipelines.
- Tipos de runners:
    - Shell
    - Docker
    - Kubernetes
- Variables de entorno y secretos protegidos.
- Cach√© y artefactos para acelerar builds.

## Seguridad y buenas pr√°cticas

- Limitar acceso SSH y usar claves.
- Activar 2FA para usuarios.
- Escaneo de dependencias y c√≥digo.
- Separar entornos (prod, staging).
- Actualizar im√°genes y backups frecuentes.

## Mantenimiento

- Backups autom√°ticos y pruebas de restauraci√≥n.
- Monitoreo de recursos (CPU, RAM, disco).
- Limpieza de artefactos antiguos.
- Actualizaciones planificadas de versi√≥n.

# gitlab ‚Äî conceptos avanzados y temas complementarios

- [devops](/devops/devops/)
- [cloud](/cloud/cloud/)
- [git](/software%20engineering/git/)
- kubernetes
- docker
- [CICD](/devops/cicd/)

## Arquitectura interna
- **Omnibus GitLab** como distribuci√≥n empaquetada:
	- Incluye PostgreSQL, Redis, NGINX, Sidekiq y Gitaly.
- **Gitaly Cluster**:
	- Escalado horizontal de repositorios Git.
	- Alta disponibilidad para grandes vol√∫menes de repos.
- **Sidekiq**:
	- Procesamiento as√≠ncrono (pipelines, emails, webhooks).
	- Colas cr√≠ticas vs no cr√≠ticas.

## Alta disponibilidad (HA)
- Separaci√≥n de servicios:
	- Base de datos PostgreSQL externa.
	- Redis en modo cluster o sentinel.
	- Balanceador de carga (HAProxy / NGINX).
- Escenarios:
	- GitLab multi-node.
	- GitLab Geo (replicaci√≥n entre regiones).

## GitLab Geo
- Replicaci√≥n **read-only** de repositorios y artefactos.
- Uso principal:
	- Equipos distribuidos geogr√°ficamente.
	- Reducci√≥n de latencia.
	- Recuperaci√≥n ante desastres (DR).
- Sincronizaci√≥n:
	- Repos Git.
	- LFS, uploads y artifacts.

## Gesti√≥n de usuarios y permisos
- Roles:
	- Guest, Reporter, Developer, Maintainer, Owner.
- Grupos y subgrupos:
	- Herencia de permisos.
	- Estructuraci√≥n organizacional.
- Integraci√≥n:
	- LDAP / Active Directory.
	- OAuth (GitHub, Google, etc.).

## Gesti√≥n de secretos
- **CI/CD Variables**:
	- Variables protegidas y enmascaradas.
- Integraci√≥n con gestores externos:
	- HashiCorp Vault.
	- Secrets de [Kubernetes](/virtualizacion/kubernetes/).
- Buenas pr√°cticas:
	- Nunca versionar secretos.
	- Rotaci√≥n peri√≥dica.

## GitLab Container Registry
- Registro privado integrado.
- Versionado de im√°genes.
- Limpieza autom√°tica (retention policies).
- Integraci√≥n directa con pipelines CI/CD.

## GitLab Package Registry
- Soporte para:
	- npm
	- Maven
	- PyPI
	- NuGet
	- Composer
- Uso como registry interno corporativo.
- Control de versiones y permisos.

## Seguridad y cumplimiento (DevSecOps)
- **Secure Stage**:
	- SAST (Static Application Security Testing).
	- DAST (Dynamic Application Security Testing).
	- Dependency Scanning.
	- Container Scanning.
- Compliance:
	- Auditor√≠a de eventos.
	- Policies de seguridad.
	- Approval rules en Merge Requests.

## Merge Requests avanzados
- Approval rules:
	- Reglas por rama o tipo de cambio.
- Code Owners:
	- Revisi√≥n obligatoria por responsables.
- Pipelines obligatorios antes de merge.
- Squash, rebase y merge strategies.

## GitOps con GitLab
- Infraestructura como c√≥digo (IaC).
- Integraci√≥n con:
	- [Terraform](/devops/terraform/)
	- Helm
	- ArgoCD
- Repos declarativos como fuente de verdad.
- Deployments autom√°ticos desde pipelines.

## Observabilidad y monitoreo
- M√©tricas internas:
	- Prometheus integrado.
- Logs centralizados.
- Alertas por rendimiento y errores.
- Monitoreo de pipelines y runners.

## Backups y Disaster Recovery
- Backups autom√°ticos:
	- Repositorios.
	- Base de datos.
	- Artefactos y uploads.
- Estrategias:
	- Snapshot de vol√∫menes.
	- Backups offsite.
- Pruebas peri√≥dicas de restore.

## Performance y optimizaci√≥n
- Ajuste de Sidekiq workers.
- Limpieza de artefactos y pipelines antiguos.
- Uso de object storage (S3, GCS, Azure Blob).
- Separaci√≥n de carga CI/CD.

## Integraciones externas
- Webhooks para eventos Git.
- Integraci√≥n con:
	- Slack
	- Jira
	- Kubernetes clusters
- APIs REST y GraphQL.

## Licencias y ediciones
- **Community Edition (CE)**:
	- Open Source.
- **Enterprise Edition (EE)**:
	- Funcionalidades avanzadas (security, compliance, HA).
- Modelo de licenciamiento por usuarios.

## Estrategias de escalado
- Vertical:
	- Aumentar recursos del nodo.
- Horizontal:
	- Separar servicios.
	- A√±adir runners.
- Cloud-native:
	- GitLab + Kubernetes.

## Roadmap y evoluci√≥n
- Enfoque en:
	- DevSecOps unificado.
	- Automatizaci√≥n end-to-end.
	- Integraci√≥n profunda con cloud providers.
- Reducci√≥n de dependencia de herramientas externas.

# gitlab ‚Äî recursos en la red (2025)

## Documentaci√≥n oficial
- **[GitLab Docs](https://docs.gitlab.com/)** ‚Äî Documentaci√≥n principal y **referencia de producto**: instalaci√≥n, CI/CD, administraci√≥n de instancias Self-Managed, comandos Git, autenticaci√≥n, runners, seguridad y m√°s.
- **[Tutoriales guiados en la documentaci√≥n](https://docs.gitlab.com/tutorials/)** ‚Äî Recorridos paso a paso por funcionalidades clave como planificaci√≥n de trabajo, pipelines, despliegues, seguridad y GitOps.
- **[Tutoriales (entrada alternativa)](https://gitlab-docs-d6a9bb.gitlab.io/ee/tutorials/index.html)** ‚Äî Gu√≠as para integraciones y funcionalidades espec√≠ficas.

## Recursos de aprendizaje y formaci√≥n
- **[Recursos oficiales de GitLab](https://about.gitlab.com/resources/)** ‚Äî Centro de recursos con blogs, demostraciones, casos de uso, eventos, newsletters, pr√°cticas recomendadas y comunidad.
- **[GitLab University](https://about.gitlab.com/learn/)** ‚Äî Cursos y rutas de aprendizaje con certificaciones para dominar GitLab y pr√°cticas DevSecOps.
- **[LinkedIn Learning ‚Äî GitLab](https://www.linkedin.com/learning/topics/gitlab)** ‚Äî Formaciones sobre uso de GitLab, CI/CD y colaboraci√≥n DevOps (actualizadas a 2025).

## Comunidad y participaci√≥n
- **[Comunidad GitLab](https://about.gitlab.com/community/)** ‚Äî Foros, Discord, programas de co-creaci√≥n, eventos y contribuci√≥n al proyecto.
- **[GitLab Hackathon](https://about.gitlab.com/community/hackathon/)** ‚Äî Eventos peri√≥dicos para contribuir a c√≥digo, documentaci√≥n y dise√±o.

## Integraci√≥n en plataformas externas
- **[Azure Static Web Apps + GitLab](https://learn.microsoft.com/es-es/azure/static-web-apps/gitlab)** ‚Äî Gu√≠a oficial para integrar repositorios GitLab con Azure Static Web Apps.

## Ayuda y soporte general
- **[Ayuda de GitLab](https://about.gitlab.com/es/get-help/)** ‚Äî Soporte, comunidad (Reddit/Discord/Stack Overflow), contribuci√≥n y actualizaciones.
- **[Get Started & Migraciones](https://about.gitlab.com/es/get-started/)** ‚Äî Comenzar con GitLab y migrar desde GitHub o Jira.

## Noticias y estado de la plataforma
- **[Redise√±o de la documentaci√≥n (2025)](https://about.gitlab.com/blog/docs-site-design-overhaul/)** ‚Äî Actualizaci√≥n visual y mejoras de navegaci√≥n (modo oscuro, UX).

## Recursos comunitarios adicionales (no oficiales)
- **Gu√≠as de terceros / Homelab**
	- *[GitLab Self-Hosted: CI/CD Completo en tu Homelab 2025](https://www.eldiarioia.es/2025/11/23/gitlab-self-hosted-ci-cd-completo-en-tu-homelab-2025/)*
- **Debates de comunidad**
	- [Reddit ‚Äî r/gitlab](https://www.reddit.com/r/gitlab/)

## Enlaces √∫tiles agrupados (obsidian)
- [GitLab Docs](https://docs.gitlab.com/)
- [Tutoriales GitLab Docs](https://docs.gitlab.com/tutorials/)
- [Recursos GitLab](https://about.gitlab.com/resources/)
- [GitLab University](https://about.gitlab.com/learn/)
- [Ayuda GitLab](https://about.gitlab.com/es/get-help/)
- [LinkedIn Learning ‚Äî GitLab](https://www.linkedin.com/learning/topics/gitlab)

# gitlab ‚Äî casos de uso y ejemplos de c√≥digo

- [devops](/devops/devops/)
- ci-cd
- docker
- kubernetes
- terraform

## CI/CD b√°sico para aplicaciones
- Automatizar build, test y deploy en cada push.
- Uso t√≠pico en proyectos backend, frontend y monorepos.
- Beneficios:
	- Feedback r√°pido.
	- Menos errores manuales.
	- Entornos reproducibles.

### Ejemplo `.gitlab-ci.yml` m√≠nimo
{% raw %}
```yaml
stages:
	- build
	- test

build_app:
	stage: build
	script:
		- echo "Building app"
		- npm install
		- npm run build

test_app:
	stage: test
	script:
		- echo "Running tests"
		- npm test
```
{% endraw %}`

## Despliegue con Docker

- Construcci√≥n de im√°genes Docker en pipelines.
- Push a **GitLab Container Registry**.
- Base para flujos GitOps y Kubernetes.

### Build y push de imagen Docker

{% raw %}
```yaml
stages:
	- docker

docker_build:
	image: docker:latest
	services:
		- docker:dind
	stage: docker
	variables:
		DOCKER_TLS_CERTDIR: ""
	script:
		- docker login -u "$CI_REGISTRY_USER" -p "$CI_REGISTRY_PASSWORD" $CI_REGISTRY
		- docker build -t $CI_REGISTRY_IMAGE:latest .
		- docker push $CI_REGISTRY_IMAGE:latest
```
{% endraw %}

## Despliegue continuo en [Kubernetes](/virtualizacion/kubernetes/)

- Uso de `kubectl` desde GitLab Runner.
- Ideal para entornos staging y producci√≥n.
- Integraci√≥n con clusters registrados en GitLab.

### Deploy a Kubernetes

{% raw %}
```yaml
deploy_prod:
	stage: deploy
	image: bitnami/kubectl:latest
	script:
		- kubectl apply -f k8s/deployment.yaml
	environment:
		name: production
		-url: https://app.example.com
```
{% endraw %}

## Infraestructura como c√≥digo (IaC)

- Automatizar provisi√≥n de infraestructura.
- Integraci√≥n nativa con [Terraform](/devops/terraform/).
- Control de cambios mediante Merge Requests.

### Pipeline con Terraform

{% raw %}
```yaml
stages:
	- validate
	- apply

terraform_validate:
	image: hashicorp/terraform:latest
	stage: validate
	script:
		- terraform init
		- terraform validate

terraform_apply:
	image: hashicorp/terraform:latest
	stage: apply
	when: manual
	script:
		- terraform apply -auto-approve
```
{% endraw %}

## GitOps

- El repositorio como **fuente de verdad**.
- Cambios declarativos para infraestructura y aplicaciones.
- Compatible con ArgoCD y Helm.

### Ejemplo de repositorio GitOps

{% raw %}
```text
repo-gitops/
	‚îú‚îÄ‚îÄ apps/
	‚îÇ	‚îú‚îÄ‚îÄ backend/
	‚îÇ	‚îÇ	‚îî‚îÄ‚îÄ deployment.yaml
	‚îÇ	‚îî‚îÄ‚îÄ frontend/
	‚îÇ		‚îî‚îÄ‚îÄ deployment.yaml
	‚îî‚îÄ‚îÄ infrastructure/
		‚îî‚îÄ‚îÄ namespaces.yaml
```
{% endraw %}

## Automatizaci√≥n de versiones y releases

- Generaci√≥n autom√°tica de tags y releases.
- Changelog controlado por commits.
- Integraci√≥n con semantic versioning.

### Crear release desde pipeline

{% raw %}
```yaml
release_job:
	stage: deploy
	image: registry.gitlab.com/gitlab-org/release-cli:latest
	script:
		- echo "Creating release"
	release:
		tag_name: v1.0.0
		name: "Release v1.0.0"
		description: "Primera versi√≥n estable"
```
{% endraw %}

## Seguridad (DevSecOps)

- Escaneo autom√°tico de c√≥digo y dependencias.
- Detecci√≥n temprana de vulnerabilidades.
- Cumplimiento de pol√≠ticas de seguridad.

### SAST b√°sico

{% raw %}
```yaml
include:
	- template: Security/SAST.gitlab-ci.yml
```
{% endraw %}

## Automatizaci√≥n con Webhooks

- Integrar GitLab con servicios externos.
- Notificaciones y acciones basadas en eventos.
- Uso com√∫n con Slack, APIs internas y bots.

### Ejemplo de payload procesado

{% raw %}
```js
app.post("/gitlab-webhook", (req, res) => {
	const event = req.headers["x-gitlab-event"];
	console.log("Evento recibido:", event);
	res.status(200).send("OK");
});
```
{% endraw %}

## Gesti√≥n de entornos

- Entornos din√°micos por branch.
- Review Apps para validaci√≥n r√°pida.
- Eliminaci√≥n autom√°tica tras merge.

### Review App

{% raw %}
```yaml
review_app:
	stage: deploy
	script:
		- echo "Deploy review app"
	environment:
		name: review/$CI_COMMIT_REF_NAME
		on_stop: stop_review

stop_review:
	stage: deploy
	script:
		- echo "Stop review app"
	when: manual
	environment:
		name: review/$CI_COMMIT_REF_NAME
		action: stop
```
{% endraw %}

## Casos de uso organizacionales

- Empresas con requisitos **self-hosted**.
- Equipos que buscan una √∫nica herramienta DevOps.
- Organizaciones con pol√≠ticas estrictas de seguridad y compliance.
- Escenarios de multi-cloud y hybrid cloud.