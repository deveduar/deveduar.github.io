---
date: 2025-12-07 20:10
title: tanstack
keywords:
source:
status: 
Parent: "[[Area-Prog]]"
public_note: "true"
category: Backend
tags:
  - tankstack
  - backend
  - framework
---
# tanstack
``$= dv.current().file.tags.join(" ")``

- [Backend](/uncategorized/backend/)
- TanStack  High Quality Open-Source Software for Web Developers-

## Qu茅 es TanStack
TanStack es un conjunto de bibliotecas open-source de alta calidad para desarrollo web, dise帽adas para ser flexibles, performantes y f谩ciles de integrar en distintos frameworks. Se centra principalmente en la gesti贸n de estado, datos y renderizado de tablas y listas complejas.

## Principales librer铆as de TanStack
- **TanStack Query**
	- Manejo de datos asincr贸nicos y cach茅 de manera eficiente.
	- Facilita la sincronizaci贸n del estado remoto con la UI.
	- Soporta consultas y mutaciones, con reintentos autom谩ticos y refetching.
	- Ejemplo b谩sico:
	
### Ejemplo: TanStack Query
{% raw %}
```javascript
import { useQuery } from '@tanstack/react-query';

function fetchUser() {
	return fetch('/api/user').then(res => res.json());
}

export default function User() {
	const { data, error, isLoading } = useQuery(['user'], fetchUser);

	if (isLoading) return 'Cargando...';
	if (error) return 'Error al cargar usuario';

	return <div>{data.name}</div>;
}
```
{% endraw %}

- **TanStack Table**
	- Herramienta para construir tablas altamente personalizables y performantes.
	- Permite sorting, filtering, pagination y virtualizaci贸n de filas.
	- Totalmente agn贸stico del framework de UI.
	- Ejemplo b谩sico:

### Ejemplo: TanStack Table
{% raw %}
```javascript
import { useReactTable, getCoreRowModel } from '@tanstack/react-table';

const data = [{ name: 'Eduardo', age: 30 }];
const columns = [{ accessorKey: 'name', header: 'Nombre' }, { accessorKey: 'age', header: 'Edad' }];

const table = useReactTable({ data, columns, getCoreRowModel: getCoreRowModel() });

return (
	<table>
		<thead>
			{table.getHeaderGroups().map(headerGroup => (
				<tr key={headerGroup.id}>
					{headerGroup.headers.map(header => <th key={header.id}>{header.isPlaceholder ? null : header.column.columnDef.header}</th>)}
				</tr>
			))}
		</thead>
		<tbody>
			{table.getRowModel().rows.map(row => (
				<tr key={row.id}>
					{row.getVisibleCells().map(cell => <td key={cell.id}>{cell.getValue()}</td>)}
				</tr>
			))}
		</tbody>
	</table>
);
```
{% endraw %}

- **TanStack Router**
	- Enrutamiento declarativo para aplicaciones modernas.
	- Soporta rutas anidadas y lazy loading.
	- Integraci贸n sencilla con React y otros frameworks.
	- Ejemplo b谩sico:

### Ejemplo: TanStack Router
{% raw %}
```javascript
import { Router, Route } from '@tanstack/router';

const router = new Router({
	routes: [
		{
			path: '/',
			component: Home,
		},
		{
			path: '/about',
			component: About,
		},
	],
});

function App() {
	return <router.Provider />;
}
```
{% endraw %}

## Beneficios de usar TanStack
- Librer铆as ligeras y altamente optimizadas.
- API consistente entre librer铆as.
- Excelente documentaci贸n y comunidad activa.
- Compatible con m煤ltiples frameworks y librer铆as de UI.
- Facilita la gesti贸n de datos y estado sin recurrir a soluciones m谩s pesadas.

## Buenas pr谩cticas
- Separar la l贸gica de datos de la UI usando TanStack Query.
- Usar memoizaci贸n y virtualizaci贸n en tablas grandes con TanStack Table.
- Definir rutas de manera declarativa y centralizada con TanStack Router.
- Mantener consistencia en nombres de queries y keys para facilitar refetching y cache.


# tankstack mas

## Estrategias avanzadas en TanStack Query
- **Caching y persistencia**
	- Configuraci贸n de cacheTime y staleTime para optimizar rendimiento.
	- Persistencia en localStorage o IndexedDB para mantener datos entre sesiones.
	- Ejemplo de cache persistente:
	{% raw %}
```javascript
	import { persistQueryClient } from '@tanstack/query-persist-client';
	import { createSyncStoragePersister } from '@tanstack/query-sync-storage-persister';
	import { QueryClient } from '@tanstack/react-query';

	const queryClient = new QueryClient();
	const persister = createSyncStoragePersister({ storage: window.localStorage });

	persistQueryClient({ queryClient, persister });
	```
{% endraw %}

- **Paginaci贸n y fetching infinito**
	- Soporta paginaci贸n autom谩tica y fetch de p谩ginas siguientes seg煤n scroll o interacci贸n.
	- Ejemplo de fetching infinito:
	{% raw %}
```javascript
	const { data, fetchNextPage, hasNextPage } = useInfiniteQuery(
		['posts'],
		({ pageParam = 0 }) => fetch(`/api/posts?page=${pageParam}`).then(res => res.json()),
		{
			getNextPageParam: lastPage => lastPage.nextCursor ?? undefined,
		}
	);
	```
{% endraw %}

- **Sincronizaci贸n en tiempo real**
	- Refetching autom谩tico al volver a foco o reconectar la app.
	- Integraci贸n con websockets o SSE para actualizaciones instant谩neas.

## Integraci贸n con TypeScript
- Todas las librer铆as TanStack est谩n dise帽adas para TypeScript.
- Permite tipado seguro en queries, mutaciones y tablas.
- Ejemplo con Tipos en TanStack Table:
{% raw %}
```typescript
interface User {
	id: number;
	name: string;
	age: number;
}

const columns = [
	{ accessorKey: 'id', header: 'ID' },
	{ accessorKey: 'name', header: 'Nombre' },
	{ accessorKey: 'age', header: 'Edad' },
] as const;

const data: User[] = [{ id: 1, name: 'Eduardo', age: 30 }];
```
{% endraw %}`

## Testing y buenas pr谩cticas

* Usar mock de queries para pruebas unitarias y de integraci贸n.
* Evitar l贸gica compleja dentro de componentes; delegar a hooks personalizados.
* Separar la definici贸n de tablas y columnas en archivos independientes para escalabilidad.
* Mantener consistencia en nomenclatura de queries y rutas para debugging m谩s sencillo.

## Casos de uso reales

* Dashboards con tablas y filtros complejos utilizando TanStack Table.
* Apps con datos en tiempo real y sincronizaci贸n offline con TanStack Query.
* SPAs con rutas anidadas y lazy loading usando TanStack Router.
* Aplicaciones que requieren tipado estricto y escalabilidad gracias a TypeScript.

## Recursos adicionales
* [Documentaci贸n oficial de TanStack](https://tanstack.com/)
* Comunidad activa en GitHub y Discord.
* Ejemplos y demos en el repositorio oficial.

## Recomendaciones finales

* Evaluar qu茅 librer铆as del stack se necesitan seg煤n el proyecto.
* Usar TanStack Query para manejo de datos, Table para visualizaci贸n y Router para navegaci贸n.
* Combinar con buenas pr谩cticas de caching, paginaci贸n y testing para proyectos escalables.


# tankstack avanzado

- [Backend](/uncategorized/backend/)
- TanStack  High Quality Open-Source Software for Web Developers-

## Tablas avanzadas con TanStack Table
- **Filtros din谩micos**
	- Permite crear filtros que se aplican sobre m煤ltiples columnas.
	- Ejemplo:
	{% raw %}
```javascript
	const [globalFilter, setGlobalFilter] = useState('');
	const table = useReactTable({
		data,
		columns,
		state: { globalFilter },
		onGlobalFilterChange: setGlobalFilter,
		getFilteredRowModel: getFilteredRowModel(),
	});
	```
{% endraw %}

- **Sorting m煤ltiple**
	- Ordenamiento por varias columnas con prioridad definida.
	{% raw %}
```javascript
	const table = useReactTable({
		data,
		columns,
		state: { sorting },
		onSortingChange: setSorting,
		getSortedRowModel: getSortedRowModel(),
	});
	```
{% endraw %}

- **Paginaci贸n controlada y virtualizaci贸n**
	- Virtualizaci贸n para manejar miles de filas sin impactar el rendimiento.
	{% raw %}
```javascript
	import { useVirtual } from '@tanstack/react-virtual';

	const rowVirtualizer = useVirtual({
		size: table.getRowModel().rows.length,
		parentRef,
		estimateSize: () => 35,
	});

	return (
		<div ref={parentRef} style={{ height: `300px`, overflow: 'auto' }}>
			<div style={{ height: `${rowVirtualizer.totalSize}px`, position: 'relative' }}>
				{rowVirtualizer.virtualItems.map(virtualRow => {
					const row = table.getRowModel().rows[virtualRow.index];
					return (
						<div key={row.id} style={{ position: 'absolute', top: 0, transform: `translateY(${virtualRow.start}px)` }}>
							{row.getVisibleCells().map(cell => <span key={cell.id}>{cell.getValue()}</span>)}
						</div>
					);
				})}
			</div>
		</div>
	);
	```
{% endraw %}

## Mutaciones optimistas con TanStack Query
- Actualiza la UI inmediatamente mientras la mutaci贸n se procesa.
- Manejo de errores y rollback en caso de fallo.
{% raw %}
```javascript
const queryClient = useQueryClient();

const mutation = useMutation(addPost, {
	onMutate: async newPost => {
		await queryClient.cancelQueries(['posts']);
		const previousPosts = queryClient.getQueryData(['posts']);
		queryClient.setQueryData(['posts'], old => [...old, newPost]);
		return { previousPosts };
	},
	onError: (err, newPost, context) => {
		queryClient.setQueryData(['posts'], context.previousPosts);
	},
	onSettled: () => {
		queryClient.invalidateQueries(['posts']);
	},
});
```
{% endraw %}`

## Rutas anidadas y lazy loading con TanStack Router

* Permite organizar aplicaciones grandes de manera escalable.

{% raw %}
```javascript
const router = new Router({
	routes: [
		{
			path: '/',
			component: Home,
			children: [
				{
					path: 'dashboard',
					component: lazy(() => import('./Dashboard')),
				},
				{
					path: 'profile/:id',
					component: Profile,
				},
			],
		},
	],
});
```
{% endraw %}

## Suscripci贸n a datos en tiempo real

* Combina TanStack Query con WebSockets o SSE.

{% raw %}
```javascript
useEffect(() => {
	const ws = new WebSocket('wss://example.com/data');
	ws.onmessage = event => {
		const newData = JSON.parse(event.data);
		queryClient.setQueryData(['liveData'], newData);
	};
	return () => ws.close();
}, [queryClient]);
```
{% endraw %}

## Estrategias de caching avanzadas

* Cache con TTL por query.
* Persistencia en localStorage o IndexedDB para offline.
* Ejemplo de cache con expiraci贸n:

{% raw %}
```javascript
const queryClient = new QueryClient({
	defaultOptions: {
		queries: {
			staleTime: 1000 * 60 * 5, // 5 minutos
			cacheTime: 1000 * 60 * 60, // 1 hora
		},
	},
});
```
{% endraw %}

## Buenas pr谩cticas avanzadas

* Separar hooks personalizados para queries y mutaciones complejas.
* Usar TypeScript para tipado estricto de datos y columnas.
* Organizar rutas y tablas en m贸dulos independientes para escalabilidad.
* Documentar keys de queries y rutas para mantener consistencia.

## Recursos adicionales y 煤tiles

* [Documentaci贸n oficial de TanStack](https://tanstack.com/)
* Ejemplos de tablas avanzadas: [TanStack Table Docs](https://tanstack.com/table/v8)
* Estrategias de caching y persistencia: [React Query Docs](https://tanstack.com/query/v5/docs/guides/persisting-query-client)
* Comunidad y soporte en GitHub y Discord.

